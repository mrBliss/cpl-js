window.CodeMirror=function(){"use strict";function CodeMirror(place,givenOptions){function drag_(e){options.onDragEvent&&options.onDragEvent(instance,addStop(e))||e_stop(e)}function isLine(l){return l>=0&&doc.size>l}function getLine(n){return getLineAt(doc,n)}function updateLineHeight(line,height){gutterDirty=!0;for(var diff=height-line.height,n=line;n;n=n.parent)n.height+=diff}function lineContent(line,wrapAt){return line.styles||line.highlight(mode,line.stateAfter=getStateBefore(lineNo(line)),options.tabSize),line.getContent(options.tabSize,wrapAt,options.lineWrapping)}function setValue(code){var top={line:0,ch:0};updateLines(top,{line:doc.size-1,ch:getLine(doc.size-1).text.length},splitLines(code),top,top),updateInput=!0}function getValue(lineSep){var text=[];return doc.iter(0,doc.size,function(line){text.push(line.text)}),text.join(lineSep||"\n")}function onScrollBar(e){scrollbar.scrollTop!=lastScrollTop&&(lastScrollTop=scroller.scrollTop=scrollbar.scrollTop,updateDisplay([]))}function onScrollMain(e){options.fixedGutter&&gutter.style.left!=scroller.scrollLeft+"px"&&(gutter.style.left=scroller.scrollLeft+"px"),scroller.scrollTop!=lastScrollTop&&(lastScrollTop=scroller.scrollTop,scrollbar.scrollTop!=lastScrollTop&&(scrollbar.scrollTop=lastScrollTop),updateDisplay([])),options.onScroll&&options.onScroll(instance)}function onMouseDown(e){function dragEnd(e2){webkit&&(scroller.draggable=!1),draggingText=!1,up(),drop(),10>Math.abs(e.clientX-e2.clientX)+Math.abs(e.clientY-e2.clientY)&&(e_preventDefault(e2),setCursor(start.line,start.ch,!0),focusInput())}function doSelect(cur){if("single"==type)setSelectionUser(start,cur);else if("double"==type){var word=findWordAt(cur);posLess(cur,startstart)?setSelectionUser(word.from,startend):setSelectionUser(startstart,word.to)}else"triple"==type&&(posLess(cur,startstart)?setSelectionUser(startend,clipPos({line:cur.line,ch:0})):setSelectionUser(startstart,clipPos({line:cur.line+1,ch:0})))}function extend(e){var cur=posFromMouse(e,!0);if(cur&&!posEq(cur,last)){focused||onFocus(),last=cur,doSelect(cur),updateInput=!1;var visible=visibleLines();(cur.line>=visible.to||visible.from>cur.line)&&(going=setTimeout(operation(function(){extend(e)}),150))}}function done(e){clearTimeout(going);var cur=posFromMouse(e);cur&&doSelect(cur),e_preventDefault(e),focusInput(),updateInput=!0,move(),up()}setShift(e_prop(e,"shiftKey"));for(var n=e_target(e);n!=wrapper;n=n.parentNode)if(n.parentNode==sizer&&n!=mover)return;for(var n=e_target(e);n!=wrapper;n=n.parentNode)if(n.parentNode==gutterText)return options.onGutterClick&&options.onGutterClick(instance,indexOf(gutterText.childNodes,n)+showingFrom,e),e_preventDefault(e);var start=posFromMouse(e);switch(e_button(e)){case 3:return gecko&&onContextMenu(e),void 0;case 2:return start&&setCursor(start.line,start.ch,!0),setTimeout(focusInput,20),e_preventDefault(e),void 0}if(!start)return e_target(e)==scroller&&e_preventDefault(e),void 0;focused||onFocus();var now=+new Date,type="single";if(lastDoubleClick&&lastDoubleClick.time>now-400&&posEq(lastDoubleClick.pos,start))type="triple",e_preventDefault(e),setTimeout(focusInput,20),selectLine(start.line);else if(lastClick&&lastClick.time>now-400&&posEq(lastClick.pos,start)){type="double",lastDoubleClick={time:now,pos:start},e_preventDefault(e);var word=findWordAt(start);setSelectionUser(word.from,word.to)}else lastClick={time:now,pos:start};var last=start,going;if(options.dragDrop&&dragAndDrop&&!options.readOnly&&!posEq(sel.from,sel.to)&&!posLess(start,sel.from)&&!posLess(sel.to,start)&&"single"==type){webkit&&(scroller.draggable=!0);var up=connect(document,"mouseup",operation(dragEnd),!0),drop=connect(scroller,"drop",operation(dragEnd),!0);return draggingText=!0,scroller.dragDrop&&scroller.dragDrop(),void 0}e_preventDefault(e),"single"==type&&setCursor(start.line,start.ch,!0);var startstart=sel.from,startend=sel.to,move=connect(document,"mousemove",operation(function(e){clearTimeout(going),e_preventDefault(e),ie||e_button(e)?extend(e):done(e)}),!0),up=connect(document,"mouseup",operation(done),!0)}function onDoubleClick(e){for(var n=e_target(e);n!=wrapper;n=n.parentNode)if(n.parentNode==gutterText)return e_preventDefault(e);e_preventDefault(e)}function onDrop(e){if(!options.onDragEvent||!options.onDragEvent(instance,addStop(e))){e_preventDefault(e);var pos=posFromMouse(e,!0),files=e.dataTransfer.files;if(pos&&!options.readOnly)if(files&&files.length&&window.FileReader&&window.File)for(var n=files.length,text=Array(n),read=0,loadFile=function(file,i){var reader=new FileReader;reader.onload=function(){text[i]=reader.result,++read==n&&(pos=clipPos(pos),operation(function(){var end=replaceRange(text.join(""),pos,pos);setSelectionUser(pos,end)})())},reader.readAsText(file)},i=0;n>i;++i)loadFile(files[i],i);else{if(draggingText&&!posLess(pos,sel.from)&&!posLess(sel.to,pos))return;try{var text=e.dataTransfer.getData("Text");text&&compoundChange(function(){var curFrom=sel.from,curTo=sel.to;setSelectionUser(pos,pos),draggingText&&replaceRange("",curFrom,curTo),replaceSelection(text),focusInput()})}catch(e){}}}}function onDragStart(e){var txt=getSelection();e.dataTransfer.setData("Text",txt),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(elt("img"),0,0)}function doHandleBinding(bound,dropShift){if("string"==typeof bound&&(bound=commands[bound],!bound))return!1;var prevShift=shiftSelecting;try{options.readOnly&&(suppressEdits=!0),dropShift&&(shiftSelecting=null),bound(instance)}catch(e){if(e!=Pass)throw e;return!1}finally{shiftSelecting=prevShift,suppressEdits=!1}return!0}function handleKeyBinding(e){function stop(){stopped=!0}var startMap=getKeyMap(options.keyMap),next=startMap.auto;clearTimeout(maybeTransition),next&&!isModifierKey(e)&&(maybeTransition=setTimeout(function(){getKeyMap(options.keyMap)==startMap&&(options.keyMap=next.call?next.call(null,instance):next)},50));var name=keyNames[e_prop(e,"keyCode")],handled=!1,flipCtrlCmd=opera&&mac;if(null==name||e.altGraphKey)return!1;e_prop(e,"altKey")&&(name="Alt-"+name),e_prop(e,flipCtrlCmd?"metaKey":"ctrlKey")&&(name="Ctrl-"+name),e_prop(e,flipCtrlCmd?"ctrlKey":"metaKey")&&(name="Cmd-"+name);var stopped=!1;return handled=e_prop(e,"shiftKey")?lookupKey("Shift-"+name,options.extraKeys,options.keyMap,function(b){return doHandleBinding(b,!0)},stop)||lookupKey(name,options.extraKeys,options.keyMap,function(b){return"string"==typeof b&&/^go[A-Z]/.test(b)?doHandleBinding(b):void 0},stop):lookupKey(name,options.extraKeys,options.keyMap,doHandleBinding,stop),stopped&&(handled=!1),handled&&(e_preventDefault(e),restartBlink(),ie&&(e.oldKeyCode=e.keyCode,e.keyCode=0)),handled}function handleCharBinding(e,ch){var handled=lookupKey("'"+ch+"'",options.extraKeys,options.keyMap,function(b){return doHandleBinding(b,!0)});return handled&&(e_preventDefault(e),restartBlink()),handled}function onKeyDown(e){if(focused||onFocus(),ie&&27==e.keyCode&&(e.returnValue=!1),pollingFast&&readInput()&&(pollingFast=!1),!options.onKeyEvent||!options.onKeyEvent(instance,addStop(e))){var code=e_prop(e,"keyCode");setShift(16==code||e_prop(e,"shiftKey"));var handled=handleKeyBinding(e);opera&&(lastStoppedKey=handled?code:null,!handled&&88==code&&e_prop(e,mac?"metaKey":"ctrlKey")&&replaceSelection(""))}}function onKeyPress(e){if(pollingFast&&readInput(),!options.onKeyEvent||!options.onKeyEvent(instance,addStop(e))){var keyCode=e_prop(e,"keyCode"),charCode=e_prop(e,"charCode");if(opera&&keyCode==lastStoppedKey)return lastStoppedKey=null,e_preventDefault(e),void 0;if(!(opera&&(!e.which||10>e.which)||khtml)||!handleKeyBinding(e)){var ch=String.fromCharCode(null==charCode?keyCode:charCode);options.electricChars&&mode.electricChars&&options.smartIndent&&!options.readOnly&&mode.electricChars.indexOf(ch)>-1&&setTimeout(operation(function(){indentLine(sel.to.line,"smart")}),75),handleCharBinding(e,ch)||fastPoll()}}}function onKeyUp(e){options.onKeyEvent&&options.onKeyEvent(instance,addStop(e))||16==e_prop(e,"keyCode")&&(shiftSelecting=null)}function onFocus(){"nocursor"!=options.readOnly&&(focused||(options.onFocus&&options.onFocus(instance),focused=!0,-1==scroller.className.search(/\bCodeMirror-focused\b/)&&(scroller.className+=" CodeMirror-focused")),slowPoll(),restartBlink())}function onBlur(){focused&&(options.onBlur&&options.onBlur(instance),focused=!1,bracketHighlighted&&operation(function(){bracketHighlighted&&(bracketHighlighted(),bracketHighlighted=null)})(),scroller.className=scroller.className.replace(" CodeMirror-focused","")),clearInterval(blinker),setTimeout(function(){focused||(shiftSelecting=null)},150)}function updateLines(from,to,newText,selFrom,selTo){if(!suppressEdits){var old=[];if(doc.iter(from.line,to.line+1,function(line){old.push(newHL(line.text,line.markedSpans))}),history)for(history.addChange(from.line,newText.length,old);history.done.length>options.undoDepth;)history.done.shift();var lines=updateMarkedSpans(hlSpans(old[0]),hlSpans(lst(old)),from.ch,to.ch,newText);updateLinesNoUndo(from,to,lines,selFrom,selTo)}}function unredoHelper(from,to){if(from.length){for(var set=from.pop(),out=[],i=set.length-1;i>=0;i-=1){var change=set[i],replaced=[],end=change.start+change.added;doc.iter(change.start,end,function(line){replaced.push(newHL(line.text,line.markedSpans))}),out.push({start:change.start,added:change.old.length,old:replaced});var pos={line:change.start+change.old.length-1,ch:editEnd(hlText(lst(replaced)),hlText(lst(change.old)))};updateLinesNoUndo({line:change.start,ch:0},{line:end-1,ch:getLine(end-1).text.length},change.old,pos,pos)}updateInput=!0,to.push(out)}}function undo(){unredoHelper(history.done,history.undone)}function redo(){unredoHelper(history.undone,history.done)}function updateLinesNoUndo(from,to,lines,selFrom,selTo){function updateLine(n){return Math.min(to.line,to.line+lendiff)>=n?n:n+lendiff}if(!suppressEdits){var recomputeMaxLength=!1,maxLineLength=maxLine.text.length;options.lineWrapping||doc.iter(from.line,to.line+1,function(line){return line.hidden||line.text.length!=maxLineLength?void 0:(recomputeMaxLength=!0,!0)}),(from.line!=to.line||lines.length>1)&&(gutterDirty=!0);var nlines=to.line-from.line,firstLine=getLine(from.line),lastLine=getLine(to.line),lastHL=lst(lines);if(0==from.ch&&0==to.ch&&""==hlText(lastHL)){for(var added=[],prevLine=null,i=0,e=lines.length-1;e>i;++i)added.push(new Line(hlText(lines[i]),hlSpans(lines[i])));lastLine.update(lastLine.text,hlSpans(lastHL)),nlines&&doc.remove(from.line,nlines,callbacks),added.length&&doc.insert(from.line,added)}else if(firstLine==lastLine)if(1==lines.length)firstLine.update(firstLine.text.slice(0,from.ch)+hlText(lines[0])+firstLine.text.slice(to.ch),hlSpans(lines[0]));else{for(var added=[],i=1,e=lines.length-1;e>i;++i)added.push(new Line(hlText(lines[i]),hlSpans(lines[i])));added.push(new Line(hlText(lastHL)+firstLine.text.slice(to.ch),hlSpans(lastHL))),firstLine.update(firstLine.text.slice(0,from.ch)+hlText(lines[0]),hlSpans(lines[0])),doc.insert(from.line+1,added)}else if(1==lines.length)firstLine.update(firstLine.text.slice(0,from.ch)+hlText(lines[0])+lastLine.text.slice(to.ch),hlSpans(lines[0])),doc.remove(from.line+1,nlines,callbacks);else{var added=[];firstLine.update(firstLine.text.slice(0,from.ch)+hlText(lines[0]),hlSpans(lines[0])),lastLine.update(hlText(lastHL)+lastLine.text.slice(to.ch),hlSpans(lastHL));for(var i=1,e=lines.length-1;e>i;++i)added.push(new Line(hlText(lines[i]),hlSpans(lines[i])));nlines>1&&doc.remove(from.line+1,nlines-1,callbacks),doc.insert(from.line+1,added)}if(options.lineWrapping){var perLine=Math.max(5,scroller.clientWidth/charWidth()-3);doc.iter(from.line,from.line+lines.length,function(line){if(!line.hidden){var guess=Math.ceil(line.text.length/perLine)||1;guess!=line.height&&updateLineHeight(line,guess)}})}else doc.iter(from.line,from.line+lines.length,function(line){var l=line.text;!line.hidden&&l.length>maxLineLength&&(maxLine=line,maxLineLength=l.length,maxLineChanged=!0,recomputeMaxLength=!1)}),recomputeMaxLength&&(updateMaxLine=!0);frontier=Math.min(frontier,from.line),startWorker(400);var lendiff=lines.length-nlines-1;if(changes.push({from:from.line,to:to.line+1,diff:lendiff}),options.onChange){for(var i=0;lines.length>i;++i)"string"!=typeof lines[i]&&(lines[i]=lines[i].text);var changeObj={from:from,to:to,text:lines};if(textChanged){for(var cur=textChanged;cur.next;cur=cur.next);cur.next=changeObj}else textChanged=changeObj}setSelection(clipPos(selFrom),clipPos(selTo),updateLine(sel.from.line),updateLine(sel.to.line))}}function needsScrollbar(){var realHeight=doc.height*textHeight()+2*paddingTop();return.99*realHeight>scroller.offsetHeight?realHeight:!1}function updateVerticalScroll(scrollTop){var scrollHeight=needsScrollbar();scrollbar.style.display=scrollHeight?"block":"none",scrollHeight?(scrollbarInner.style.height=sizer.style.minHeight=scrollHeight+"px",scrollbar.style.height=scroller.clientHeight+"px",null!=scrollTop&&(scrollbar.scrollTop=scroller.scrollTop=scrollTop,webkit&&setTimeout(function(){scrollbar.scrollTop==scrollTop&&(scrollbar.scrollTop=scrollTop+(scrollTop?-1:1),scrollbar.scrollTop=scrollTop)},0))):sizer.style.minHeight="",mover.style.top=displayOffset*textHeight()+"px"}function computeMaxLength(){maxLine=getLine(0),maxLineChanged=!0;var maxLineLength=maxLine.text.length;doc.iter(1,doc.size,function(line){var l=line.text;!line.hidden&&l.length>maxLineLength&&(maxLineLength=l.length,maxLine=line)}),updateMaxLine=!1}function replaceRange(code,from,to){function adjustPos(pos){if(posLess(pos,from))return pos;if(!posLess(to,pos))return end;var line=pos.line+code.length-(to.line-from.line)-1,ch=pos.ch;return pos.line==to.line&&(ch+=lst(code).length-(to.ch-(to.line==from.line?from.ch:0))),{line:line,ch:ch}}from=clipPos(from),to=to?clipPos(to):from,code=splitLines(code);var end;return replaceRange1(code,from,to,function(end1){return end=end1,{from:adjustPos(sel.from),to:adjustPos(sel.to)}}),end}function replaceSelection(code,collapse){replaceRange1(splitLines(code),sel.from,sel.to,function(end){return"end"==collapse?{from:end,to:end}:"start"==collapse?{from:sel.from,to:sel.from}:{from:sel.from,to:end}})}function replaceRange1(code,from,to,computeSel){var endch=1==code.length?code[0].length+from.ch:lst(code).length,newSel=computeSel({line:from.line+code.length-1,ch:endch});updateLines(from,to,code,newSel.from,newSel.to)}function getRange(from,to,lineSep){var l1=from.line,l2=to.line;if(l1==l2)return getLine(l1).text.slice(from.ch,to.ch);var code=[getLine(l1).text.slice(from.ch)];return doc.iter(l1+1,l2,function(line){code.push(line.text)}),code.push(getLine(l2).text.slice(0,to.ch)),code.join(lineSep||"\n")}function getSelection(lineSep){return getRange(sel.from,sel.to,lineSep)}function slowPoll(){pollingFast||poll.set(options.pollInterval,function(){readInput(),focused&&slowPoll()})}function fastPoll(){function p(){var changed=readInput();changed||missed?(pollingFast=!1,slowPoll()):(missed=!0,poll.set(60,p))}var missed=!1;pollingFast=!0,poll.set(20,p)}function readInput(){if(!focused||hasSelection(input)||options.readOnly)return!1;var text=input.value;if(text==prevInput)return!1;nestedOperation||startOperation(),shiftSelecting=null;for(var same=0,l=Math.min(prevInput.length,text.length);l>same&&prevInput[same]==text[same];)++same;return prevInput.length>same?sel.from={line:sel.from.line,ch:sel.from.ch-(prevInput.length-same)}:overwrite&&posEq(sel.from,sel.to)&&!pasteIncoming&&(sel.to={line:sel.to.line,ch:Math.min(getLine(sel.to.line).text.length,sel.to.ch+(text.length-same))}),replaceSelection(text.slice(same),"end"),text.length>1e3?input.value=prevInput="":prevInput=text,nestedOperation||endOperation(),pasteIncoming=!1,!0}function resetInput(user){posEq(sel.from,sel.to)?user&&(prevInput=input.value=""):(prevInput="",input.value=getSelection(),focused&&selectInput(input))}function focusInput(){"nocursor"!=options.readOnly&&input.focus()}function scrollCursorIntoView(){var coords=calculateCursorCoords();if(scrollIntoView(coords.x,coords.y,coords.x,coords.yBot),focused){var box=sizer.getBoundingClientRect(),doScroll=null;if(0>coords.y+box.top?doScroll=!0:coords.y+box.top+textHeight()>(window.innerHeight||document.documentElement.clientHeight)&&(doScroll=!1),null!=doScroll){var hidden="none"==cursor.style.display;hidden&&(cursor.style.display="",cursor.style.left=coords.x+"px",cursor.style.top=coords.y-displayOffset+"px"),cursor.scrollIntoView(doScroll),hidden&&(cursor.style.display="none")}}}function calculateCursorCoords(){var cursor=localCoords(sel.inverted?sel.from:sel.to),x=options.lineWrapping?Math.min(cursor.x,lineSpace.offsetWidth):cursor.x;return{x:x,y:cursor.y,yBot:cursor.yBot}}function scrollIntoView(x1,y1,x2,y2){var scrollPos=calculateScrollPos(x1,y1,x2,y2);null!=scrollPos.scrollLeft&&(scroller.scrollLeft=scrollPos.scrollLeft),null!=scrollPos.scrollTop&&(scrollbar.scrollTop=scroller.scrollTop=scrollPos.scrollTop)}function calculateScrollPos(x1,y1,x2,y2){var pl=paddingLeft(),pt=paddingTop();y1+=pt,y2+=pt,x1+=pl,x2+=pl;var screen=scroller.clientHeight,screentop=scrollbar.scrollTop,result={},docBottom=needsScrollbar()||1/0,atTop=pt+10>y1,atBottom=y2+pt>docBottom-10;screentop>y1?result.scrollTop=atTop?0:Math.max(0,y1):y2>screentop+screen&&(result.scrollTop=(atBottom?docBottom:y2)-screen);var screenw=scroller.clientWidth,screenleft=scroller.scrollLeft,gutterw=options.fixedGutter?gutter.clientWidth:0,atLeft=gutterw+pl+10>x1;return screenleft+gutterw>x1||atLeft?(atLeft&&(x1=0),result.scrollLeft=Math.max(0,x1-10-gutterw)):x2>screenw+screenleft-3&&(result.scrollLeft=x2+10-screenw),result}function visibleLines(scrollTop){var lh=textHeight(),top=(null!=scrollTop?scrollTop:scrollbar.scrollTop)-paddingTop(),fromHeight=Math.max(0,Math.floor(top/lh)),toHeight=Math.ceil((top+scroller.clientHeight)/lh);return{from:lineAtHeight(doc,fromHeight),to:lineAtHeight(doc,toHeight)}}function updateDisplay(changes,suppressCallback,scrollTop){function checkHeights(){var curNode=lineDiv.firstChild,heightChanged=!1;return doc.iter(showingFrom,showingTo,function(line){if(curNode){if(!line.hidden){var height=Math.round(curNode.offsetHeight/th)||1;line.height!=height&&(updateLineHeight(line,height),gutterDirty=heightChanged=!0)}curNode=curNode.nextSibling}}),heightChanged}if(!scroller.clientWidth)return showingFrom=showingTo=displayOffset=0,void 0;var visible=visibleLines(scrollTop);if(changes!==!0&&0==changes.length&&visible.from>showingFrom&&showingTo>visible.to)return updateVerticalScroll(scrollTop),void 0;var from=Math.max(visible.from-100,0),to=Math.min(doc.size,visible.to+100);from>showingFrom&&20>from-showingFrom&&(from=showingFrom),showingTo>to&&20>showingTo-to&&(to=Math.min(doc.size,showingTo));for(var intact=changes===!0?[]:computeIntact([{from:showingFrom,to:showingTo,domStart:0}],changes),intactLines=0,i=0;intact.length>i;++i){var range=intact[i];from>range.from&&(range.domStart+=from-range.from,range.from=from),range.to>to&&(range.to=to),range.from>=range.to?intact.splice(i--,1):intactLines+=range.to-range.from}if(intactLines==to-from&&from==showingFrom&&to==showingTo)return updateVerticalScroll(scrollTop),void 0;intact.sort(function(a,b){return a.domStart-b.domStart});var th=textHeight(),gutterDisplay=gutter.style.display;lineDiv.style.display="none",patchDisplay(from,to,intact),lineDiv.style.display=gutter.style.display="";var different=from!=showingFrom||to!=showingTo||lastSizeC!=scroller.clientHeight+th;if(different&&(lastSizeC=scroller.clientHeight+th),(from!=showingFrom||to!=showingTo&&options.onViewportChange)&&setTimeout(function(){options.onViewportChange&&options.onViewportChange(instance,from,to)}),showingFrom=from,showingTo=to,displayOffset=heightAtLine(doc,from),startWorker(100),lineDiv.childNodes.length!=showingTo-showingFrom)throw new Error("BAD PATCH! "+JSON.stringify(intact)+" size="+(showingTo-showingFrom)+" nodes="+lineDiv.childNodes.length);return options.lineWrapping&&checkHeights(),gutter.style.display=gutterDisplay,(different||gutterDirty)&&updateGutter()&&options.lineWrapping&&checkHeights()&&updateGutter(),updateVerticalScroll(scrollTop),updateSelection(),!suppressCallback&&options.onUpdate&&options.onUpdate(instance),!0}function computeIntact(intact,changes){for(var i=0,l=changes.length||0;l>i;++i){for(var change=changes[i],intact2=[],diff=change.diff||0,j=0,l2=intact.length;l2>j;++j){var range=intact[j];range.from>=change.to&&change.diff?intact2.push({from:range.from+diff,to:range.to+diff,domStart:range.domStart}):range.from>=change.to||change.from>=range.to?intact2.push(range):(change.from>range.from&&intact2.push({from:range.from,to:change.from,domStart:range.domStart}),range.to>change.to&&intact2.push({from:change.to+diff,to:range.to+diff,domStart:range.domStart+(change.to-range.from)}))}intact=intact2}return intact}function patchDisplay(from,to,intact){function killNode(node){var tmp=node.nextSibling;return node.parentNode.removeChild(node),tmp}if(intact.length){for(var domPos=0,curNode=lineDiv.firstChild,n,i=0;intact.length>i;++i){for(var cur=intact[i];cur.domStart>domPos;)curNode=killNode(curNode),domPos++;for(var j=0,e=cur.to-cur.from;e>j;++j)curNode=curNode.nextSibling,domPos++}for(;curNode;)curNode=killNode(curNode)}else removeChildren(lineDiv);var nextIntact=intact.shift(),curNode=lineDiv.firstChild,j=from;doc.iter(from,to,function(line){if(nextIntact&&nextIntact.to==j&&(nextIntact=intact.shift()),!nextIntact||nextIntact.from>j){if(line.hidden)var lineElement=elt("pre");else{var lineElement=lineContent(line);if(line.className&&(lineElement.className=line.className),line.bgClassName){var pre=elt("pre"," ",line.bgClassName,"position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: -2");lineElement=elt("div",[pre,lineElement],null,"position: relative")}}lineDiv.insertBefore(lineElement,curNode)}else curNode=curNode.nextSibling;++j})}function updateGutter(){if(options.gutter||options.lineNumbers){var hText=mover.offsetHeight,hEditor=scroller.clientHeight;gutter.style.height=(2>hText-hEditor?hEditor:hText)+"px";var fragment=document.createDocumentFragment(),i=showingFrom,normalNode;if(doc.iter(showingFrom,Math.max(showingTo,showingFrom+1),function(line){if(line.hidden)fragment.appendChild(elt("pre"));else{var marker=line.gutterMarker,text=options.lineNumbers?options.lineNumberFormatter(i+options.firstLineNumber):null;marker&&marker.text?text=marker.text.replace("%N%",null!=text?text:""):null==text&&(text=" ");var markerElement=fragment.appendChild(elt("pre",null,marker&&marker.style));markerElement.innerHTML=text;for(var j=1;line.height>j;++j)markerElement.appendChild(elt("br")),markerElement.appendChild(document.createTextNode(" "));marker||(normalNode=i)}++i}),gutter.style.display="none",removeChildrenAndAdd(gutterText,fragment),null!=normalNode&&options.lineNumbers){for(var node=gutterText.childNodes[normalNode-showingFrom],minwidth=String(doc.size).length,val=eltText(node.firstChild),pad="";minwidth>val.length+pad.length;)pad+=" ";pad&&node.insertBefore(document.createTextNode(pad),node.firstChild)}gutter.style.display="";var resized=Math.abs((parseInt(lineSpace.style.marginLeft)||0)-gutter.offsetWidth)>2;return lineSpace.style.marginLeft=gutter.offsetWidth+"px",gutterDirty=!1,resized}}function updateSelection(){var collapsed=posEq(sel.from,sel.to),fromPos=localCoords(sel.from,!0),toPos=collapsed?fromPos:localCoords(sel.to,!0),headPos=sel.inverted?fromPos:toPos,th=textHeight(),wrapOff=eltOffset(wrapper),lineOff=eltOffset(lineDiv);if(inputDiv.style.top=Math.max(0,Math.min(scroller.offsetHeight,headPos.y+lineOff.top-wrapOff.top))+"px",inputDiv.style.left=Math.max(0,Math.min(scroller.offsetWidth,headPos.x+lineOff.left-wrapOff.left))+"px",collapsed)cursor.style.top=headPos.y+"px",cursor.style.left=(options.lineWrapping?Math.min(headPos.x,lineSpace.offsetWidth):headPos.x)+"px",cursor.style.display="",selectionDiv.style.display="none";else{var sameLine=fromPos.y==toPos.y,fragment=document.createDocumentFragment(),clientWidth=lineSpace.clientWidth||lineSpace.offsetWidth,clientHeight=lineSpace.clientHeight||lineSpace.offsetHeight,add=function(left,top,right,height){var rstyle=quirksMode?"width: "+(right?clientWidth-right-left:clientWidth)+"px":"right: "+right+"px";fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px; top: "+top+"px; "+rstyle+"; height: "+height+"px"))};if(sel.from.ch&&fromPos.y>=0){var right=sameLine?clientWidth-toPos.x:0;add(fromPos.x,fromPos.y,right,th)}var middleStart=Math.max(0,fromPos.y+(sel.from.ch?th:0)),middleHeight=Math.min(toPos.y,clientHeight)-middleStart;middleHeight>.2*th&&add(0,middleStart,0,middleHeight),sameLine&&sel.from.ch||!(clientHeight-.5*th>toPos.y)||add(0,toPos.y,clientWidth-toPos.x,th),removeChildrenAndAdd(selectionDiv,fragment),cursor.style.display="none",selectionDiv.style.display=""}}function setShift(val){shiftSelecting=val?shiftSelecting||(sel.inverted?sel.to:sel.from):null}function setSelectionUser(from,to){var sh=shiftSelecting&&clipPos(shiftSelecting);sh&&(posLess(sh,from)?from=sh:posLess(to,sh)&&(to=sh)),setSelection(from,to),userSelChange=!0}function setSelection(from,to,oldFrom,oldTo){if(goalColumn=null,null==oldFrom&&(oldFrom=sel.from.line,oldTo=sel.to.line),!posEq(sel.from,from)||!posEq(sel.to,to)){if(posLess(to,from)){var tmp=to;to=from,from=tmp}if(from.line!=oldFrom){var from1=skipHidden(from,oldFrom,sel.from.ch);from1?from=from1:setLineHidden(from.line,!1)}if(to.line!=oldTo&&(to=skipHidden(to,oldTo,sel.to.ch)),posEq(from,to)?sel.inverted=!1:posEq(from,sel.to)?sel.inverted=!1:posEq(to,sel.from)&&(sel.inverted=!0),options.autoClearEmptyLines&&posEq(sel.from,sel.to)){var head=sel.inverted?from:to;if(head.line!=sel.from.line&&doc.size>sel.from.line){var oldLine=getLine(sel.from.line);/^\s+$/.test(oldLine.text)&&setTimeout(operation(function(){if(oldLine.parent&&/^\s+$/.test(oldLine.text)){var no=lineNo(oldLine);replaceRange("",{line:no,ch:0},{line:no,ch:oldLine.text.length})}},10))}}sel.from=from,sel.to=to,selectionChanged=!0}}function skipHidden(pos,oldLine,oldCh){function getNonHidden(dir){for(var lNo=pos.line+dir,end=1==dir?doc.size:-1;lNo!=end;){var line=getLine(lNo);if(!line.hidden){var ch=pos.ch;return(toEnd||ch>oldCh||ch>line.text.length)&&(ch=line.text.length),{line:lNo,ch:ch}}lNo+=dir}}var line=getLine(pos.line),toEnd=pos.ch==line.text.length&&pos.ch!=oldCh;return line.hidden?pos.line>=oldLine?getNonHidden(1)||getNonHidden(-1):getNonHidden(-1)||getNonHidden(1):pos}function setCursor(line,ch,user){var pos=clipPos({line:line,ch:ch||0});(user?setSelectionUser:setSelection)(pos,pos)}function clipLine(n){return Math.max(0,Math.min(n,doc.size-1))}function clipPos(pos){if(0>pos.line)return{line:0,ch:0};if(pos.line>=doc.size)return{line:doc.size-1,ch:getLine(doc.size-1).text.length};var ch=pos.ch,linelen=getLine(pos.line).text.length;return null==ch||ch>linelen?{line:pos.line,ch:linelen}:0>ch?{line:pos.line,ch:0}:pos}function findPosH(dir,unit){function findNextLine(){for(var l=line+dir,e=0>dir?-1:doc.size;l!=e;l+=dir){var lo=getLine(l);if(!lo.hidden)return line=l,lineObj=lo,!0}}function moveOnce(boundToLine){if(ch==(0>dir?0:lineObj.text.length)){if(boundToLine||!findNextLine())return!1;ch=0>dir?lineObj.text.length:0}else ch+=dir;return!0}var end=sel.inverted?sel.from:sel.to,line=end.line,ch=end.ch,lineObj=getLine(line);if("char"==unit)moveOnce();else if("column"==unit)moveOnce(!0);else if("word"==unit)for(var sawWord=!1;!(0>dir)||moveOnce();){if(isWordChar(lineObj.text.charAt(ch)))sawWord=!0;else if(sawWord){0>dir&&(dir=1,moveOnce());break}if(dir>0&&!moveOnce())break}return{line:line,ch:ch}}function moveH(dir,unit){var pos=0>dir?sel.from:sel.to;(shiftSelecting||posEq(sel.from,sel.to))&&(pos=findPosH(dir,unit)),setCursor(pos.line,pos.ch,!0)}function deleteH(dir,unit){posEq(sel.from,sel.to)?0>dir?replaceRange("",findPosH(dir,unit),sel.to):replaceRange("",sel.from,findPosH(dir,unit)):replaceRange("",sel.from,sel.to),userSelChange=!0}function moveV(dir,unit){var dist=0,pos=localCoords(sel.inverted?sel.from:sel.to,!0);if(null!=goalColumn&&(pos.x=goalColumn),"page"==unit)var screen=Math.min(scroller.clientHeight,window.innerHeight||document.documentElement.clientHeight),target=coordsChar(pos.x,pos.y+screen*dir);else if("line"==unit)var th=textHeight(),target=coordsChar(pos.x,pos.y+.5*th+dir*th);"page"==unit&&(scrollbar.scrollTop+=localCoords(target,!0).y-pos.y),setCursor(target.line,target.ch,!0),goalColumn=pos.x}function findWordAt(pos){var line=getLine(pos.line).text,start=pos.ch,end=pos.ch;if(line){pos.after===!1||end==line.length?--start:++end;for(var startChar=line.charAt(start),check=isWordChar(startChar)?isWordChar:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&isWordChar(ch)};start>0&&check(line.charAt(start-1));)--start;for(;line.length>end&&check(line.charAt(end));)++end}return{from:{line:pos.line,ch:start},to:{line:pos.line,ch:end}}}function selectLine(line){setSelectionUser({line:line,ch:0},clipPos({line:line+1,ch:0}))}function indentSelected(mode){if(posEq(sel.from,sel.to))return indentLine(sel.from.line,mode);for(var e=sel.to.line-(sel.to.ch?0:1),i=sel.from.line;e>=i;++i)indentLine(i,mode)}function indentLine(n,how){if(how||(how="add"),"smart"==how)if(mode.indent)var state=getStateBefore(n);else how="prev";var line=getLine(n),curSpace=line.indentation(options.tabSize),curSpaceString=line.text.match(/^\s*/)[0],indentation;"smart"==how&&(indentation=mode.indent(state,line.text.slice(curSpaceString.length),line.text),indentation==Pass&&(how="prev")),"prev"==how?indentation=n?getLine(n-1).indentation(options.tabSize):0:"add"==how?indentation=curSpace+options.indentUnit:"subtract"==how&&(indentation=curSpace-options.indentUnit),indentation=Math.max(0,indentation);var diff=indentation-curSpace,indentString="",pos=0;if(options.indentWithTabs)for(var i=Math.floor(indentation/options.tabSize);i;--i)pos+=options.tabSize,indentString+="	";indentation>pos&&(indentString+=spaceStr(indentation-pos)),indentString!=curSpaceString&&replaceRange(indentString,{line:n,ch:0},{line:n,ch:curSpaceString.length}),line.stateAfter=null}function loadMode(){mode=CodeMirror.getMode(options,options.mode),doc.iter(0,doc.size,function(line){line.stateAfter=null}),frontier=0,startWorker(100)}function gutterChanged(){var visible=options.gutter||options.lineNumbers;gutter.style.display=visible?"":"none",visible?gutterDirty=!0:lineDiv.parentNode.style.marginLeft=0}function wrappingChanged(from,to){if(options.lineWrapping){wrapper.className+=" CodeMirror-wrap";var perLine=scroller.clientWidth/charWidth()-3;doc.iter(0,doc.size,function(line){if(!line.hidden){var guess=Math.ceil(line.text.length/perLine)||1;1!=guess&&updateLineHeight(line,guess)}}),lineSpace.style.minWidth=widthForcer.style.left=""}else wrapper.className=wrapper.className.replace(" CodeMirror-wrap",""),computeMaxLength(),doc.iter(0,doc.size,function(line){1==line.height||line.hidden||updateLineHeight(line,1)});changes.push({from:0,to:doc.size})}function themeChanged(){scroller.className=scroller.className.replace(/\s*cm-s-\S+/g,"")+options.theme.replace(/(^|\s)\s*/g," cm-s-")}function keyMapChanged(){var style=keyMap[options.keyMap].style;wrapper.className=wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(style?" cm-keymap-"+style:"")}function TextMarker(type,style){this.lines=[],this.type=type,style&&(this.style=style)}function markText(from,to,className,options){from=clipPos(from),to=clipPos(to);var marker=new TextMarker("range",className);if(options)for(var opt in options)options.hasOwnProperty(opt)&&(marker[opt]=options[opt]);var curLine=from.line;return doc.iter(curLine,to.line+1,function(line){var span={from:curLine==from.line?from.ch:null,to:curLine==to.line?to.ch:null,marker:marker};line.markedSpans=(line.markedSpans||[]).concat([span]),marker.lines.push(line),++curLine}),changes.push({from:from.line,to:to.line+1}),marker}function setBookmark(pos){pos=clipPos(pos);var marker=new TextMarker("bookmark"),line=getLine(pos.line);
history.addChange(pos.line,1,[newHL(line.text,line.markedSpans)],!0);var span={from:pos.ch,to:pos.ch,marker:marker};return line.markedSpans=(line.markedSpans||[]).concat([span]),marker.lines.push(line),marker}function findMarksAt(pos){pos=clipPos(pos);var markers=[],spans=getLine(pos.line).markedSpans;if(spans)for(var i=0;spans.length>i;++i){var span=spans[i];(null==span.from||pos.ch>=span.from)&&(null==span.to||span.to>=pos.ch)&&markers.push(span.marker)}return markers}function addGutterMarker(line,text,className){return"number"==typeof line&&(line=getLine(clipLine(line))),line.gutterMarker={text:text,style:className},gutterDirty=!0,line}function removeGutterMarker(line){"number"==typeof line&&(line=getLine(clipLine(line))),line.gutterMarker=null,gutterDirty=!0}function changeLine(handle,op){var no=handle,line=handle;return"number"==typeof handle?line=getLine(clipLine(handle)):no=lineNo(handle),null==no?null:op(line,no)?(changes.push({from:no,to:no+1}),line):null}function setLineClass(handle,className,bgClassName){return changeLine(handle,function(line){return line.className!=className||line.bgClassName!=bgClassName?(line.className=className,line.bgClassName=bgClassName,!0):void 0})}function setLineHidden(handle,hidden){return changeLine(handle,function(line,no){if(line.hidden!=hidden){line.hidden=hidden,options.lineWrapping||(hidden&&line.text.length==maxLine.text.length?updateMaxLine=!0:!hidden&&line.text.length>maxLine.text.length&&(maxLine=line,updateMaxLine=!1)),updateLineHeight(line,hidden?0:1);var fline=sel.from.line,tline=sel.to.line;if(hidden&&(fline==no||tline==no)){var from=fline==no?skipHidden({line:fline,ch:0},fline,0):sel.from,to=tline==no?skipHidden({line:tline,ch:0},tline,0):sel.to;if(!to)return;setSelection(from,to)}return gutterDirty=!0}})}function lineInfo(line){if("number"==typeof line){if(!isLine(line))return null;var n=line;if(line=getLine(line),!line)return null}else{var n=lineNo(line);if(null==n)return null}var marker=line.gutterMarker;return{line:n,handle:line,text:line.text,markerText:marker&&marker.text,markerClass:marker&&marker.style,lineClass:line.className,bgClass:line.bgClassName}}function measureLine(line,ch){if(0==ch)return{top:0,left:0};var pre=lineContent(line,ch);removeChildrenAndAdd(measure,pre);var anchor=pre.anchor,top=anchor.offsetTop,left=anchor.offsetLeft;if(ie&&0==top&&0==left){var backup=elt("span","x");anchor.parentNode.insertBefore(backup,anchor.nextSibling),top=backup.offsetTop}return{top:top,left:left}}function localCoords(pos,inLineWrap){var x,lh=textHeight(),y=lh*(heightAtLine(doc,pos.line)-(inLineWrap?displayOffset:0));if(0==pos.ch)x=0;else{var sp=measureLine(getLine(pos.line),pos.ch);x=sp.left,options.lineWrapping&&(y+=Math.max(0,sp.top))}return{x:x,y:y,yBot:y+lh}}function coordsChar(x,y){function getX(len){var sp=measureLine(lineObj,len);if(tw){var off=Math.round(sp.top/th);return wrongLine=off!=innerOff,Math.max(0,sp.left+(off-innerOff)*scroller.clientWidth)}return sp.left}var th=textHeight(),cw=charWidth(),heightPos=displayOffset+Math.floor(y/th);if(0>heightPos)return{line:0,ch:0};var lineNo=lineAtHeight(doc,heightPos);if(lineNo>=doc.size)return{line:doc.size-1,ch:getLine(doc.size-1).text.length};var lineObj=getLine(lineNo),text=lineObj.text,tw=options.lineWrapping,innerOff=tw?heightPos-heightAtLine(doc,lineNo):0;if(0>=x&&0==innerOff)return{line:lineNo,ch:0};for(var wrongLine=!1,from=0,fromX=0,to=text.length,toX,estimated=Math.min(to,Math.ceil((x+.9*innerOff*scroller.clientWidth)/cw));;){var estX=getX(estimated);if(!(x>=estX&&to>estimated)){toX=estX,to=estimated;break}estimated=Math.min(to,Math.ceil(1.2*estimated))}if(x>toX)return{line:lineNo,ch:to};for(estimated=Math.floor(.8*to),estX=getX(estimated),x>estX&&(from=estimated,fromX=estX);;){if(1>=to-from){var after=toX-x>x-fromX;return{line:lineNo,ch:after?from:to,after:after}}var middle=Math.ceil((from+to)/2),middleX=getX(middle);middleX>x?(to=middle,toX=middleX,wrongLine&&(toX+=1e3)):(from=middle,fromX=middleX)}}function pageCoords(pos){var local=localCoords(pos,!0),off=eltOffset(lineSpace);return{x:off.left+local.x,y:off.top+local.y,yBot:off.top+local.yBot}}function textHeight(){if(null==measurePre){measurePre=elt("pre");for(var i=0;49>i;++i)measurePre.appendChild(document.createTextNode("x")),measurePre.appendChild(elt("br"));measurePre.appendChild(document.createTextNode("x"))}var offsetHeight=lineDiv.clientHeight;return offsetHeight==cachedHeightFor?cachedHeight:(cachedHeightFor=offsetHeight,removeChildrenAndAdd(measure,measurePre.cloneNode(!0)),cachedHeight=measure.firstChild.offsetHeight/50||1,removeChildren(measure),cachedHeight)}function charWidth(){if(scroller.clientWidth==cachedWidthFor)return cachedWidth;cachedWidthFor=scroller.clientWidth;var anchor=elt("span","x"),pre=elt("pre",[anchor]);return removeChildrenAndAdd(measure,pre),cachedWidth=anchor.offsetWidth||10}function paddingTop(){return lineSpace.offsetTop}function paddingLeft(){return lineSpace.offsetLeft}function posFromMouse(e,liberal){var offW=eltOffset(scroller,!0),x,y;try{x=e.clientX,y=e.clientY}catch(e){return null}if(!liberal&&(x-offW.left>scroller.clientWidth||y-offW.top>scroller.clientHeight))return null;var offL=eltOffset(lineSpace,!0);return coordsChar(x-offL.left,y-offL.top)}function onContextMenu(e){function rehide(){if(inputDiv.style.position="relative",input.style.cssText=oldCSS,ie_lt9&&(scrollbar.scrollTop=scrollPos),slowPoll(),null!=input.selectionStart){clearTimeout(detectingSelectAll);var extval=input.value=" "+(posEq(sel.from,sel.to)?"":input.value),i=0;prevInput=" ",input.selectionStart=1,input.selectionEnd=extval.length,detectingSelectAll=setTimeout(function poll(){" "==prevInput&&0==input.selectionStart?operation(commands.selectAll)(instance):10>i++?detectingSelectAll=setTimeout(poll,500):resetInput()},200)}}var pos=posFromMouse(e),scrollPos=scrollbar.scrollTop;if(pos&&!opera){(posEq(sel.from,sel.to)||posLess(pos,sel.from)||!posLess(pos,sel.to))&&operation(setCursor)(pos.line,pos.ch);var oldCSS=input.style.cssText;if(inputDiv.style.position="absolute",input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: white; "+"border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",focusInput(),resetInput(!0),posEq(sel.from,sel.to)&&(input.value=prevInput=" "),gecko){e_stop(e);var mouseup=connect(window,"mouseup",function(){mouseup(),setTimeout(rehide,20)},!0)}else setTimeout(rehide,50)}}function restartBlink(){clearInterval(blinker);var on=!0;cursor.style.visibility="",blinker=setInterval(function(){cursor.style.visibility=(on=!on)?"":"hidden"},options.cursorBlinkRate)}function matchBrackets(autoclear){function scan(line,from,to){if(line.text)for(var st=line.styles,pos=forward?0:line.text.length-1,cur,i=forward?0:st.length-2,e=forward?st.length:-2;i!=e;i+=2*d){var text=st[i];if(st[i+1]==style){for(var j=forward?0:text.length-1,te=forward?text.length:-1;j!=te;j+=d,pos+=d)if(pos>=from&&to>pos&&re.test(cur=text.charAt(j))){var match=matching[cur];if(">"==match.charAt(1)==forward)stack.push(cur);else{if(stack.pop()!=match.charAt(0))return{pos:pos,match:!1};if(!stack.length)return{pos:pos,match:!0}}}}else pos+=d*text.length}}var head=sel.inverted?sel.from:sel.to,line=getLine(head.line),pos=head.ch-1,match=pos>=0&&matching[line.text.charAt(pos)]||matching[line.text.charAt(++pos)];if(match){for(var ch=match.charAt(0),forward=">"==match.charAt(1),d=forward?1:-1,st=line.styles,off=pos+1,i=0,e=st.length;e>i;i+=2)if(0>=(off-=st[i].length)){var style=st[i+1];break}for(var stack=[line.text.charAt(pos)],re=/[(){}[\]]/,i=head.line,e=forward?Math.min(i+100,doc.size):Math.max(-1,i-100);i!=e;i+=d){var line=getLine(i),first=i==head.line,found=scan(line,first&&forward?pos+1:0,first&&!forward?pos:line.text.length);if(found)break}found||(found={pos:null,match:!1});var style=found.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",one=markText({line:head.line,ch:pos},{line:head.line,ch:pos+1},style),two=null!=found.pos&&markText({line:i,ch:found.pos},{line:i,ch:found.pos+1},style),clear=operation(function(){one.clear(),two&&two.clear()});autoclear?setTimeout(clear,800):bracketHighlighted=clear}}function findStartLine(n){for(var minindent,minline,search=n,lim=n-40;search>lim;--search){if(0==search)return 0;var line=getLine(search-1);if(line.stateAfter)return search;var indented=line.indentation(options.tabSize);(null==minline||minindent>indented)&&(minline=search-1,minindent=indented)}return minline}function getStateBefore(n){var pos=findStartLine(n),state=pos&&getLine(pos-1).stateAfter;return state=state?copyState(mode,state):startState(mode),doc.iter(pos,n,function(line){line.process(mode,state,options.tabSize),line.stateAfter=pos==n-1||0==pos%5?copyState(mode,state):null}),state}function highlightWorker(){if(!(frontier>=showingTo)){var end=+new Date+options.workTime,state=copyState(mode,getStateBefore(frontier)),startFrontier=frontier;doc.iter(frontier,showingTo,function(line){return frontier>=showingFrom?(line.highlight(mode,state,options.tabSize),line.stateAfter=copyState(mode,state)):(line.process(mode,state,options.tabSize),line.stateAfter=0==frontier%5?copyState(mode,state):null),++frontier,+new Date>end?(startWorker(options.workDelay),!0):void 0}),showingTo>startFrontier&&frontier>=showingFrom&&operation(function(){changes.push({from:startFrontier,to:frontier})})()}}function startWorker(time){showingTo>frontier&&highlight.set(time,highlightWorker)}function startOperation(){updateInput=userSelChange=textChanged=null,changes=[],selectionChanged=!1,callbacks=[]}function endOperation(){if(updateMaxLine&&computeMaxLength(),maxLineChanged&&!options.lineWrapping){var cursorWidth=widthForcer.offsetWidth,left=measureLine(maxLine,maxLine.text.length).left;ie_lt8||(widthForcer.style.left=left+"px",lineSpace.style.minWidth=left+cursorWidth+"px"),maxLineChanged=!1}var newScrollPos,updated;if(selectionChanged){var coords=calculateCursorCoords();newScrollPos=calculateScrollPos(coords.x,coords.y,coords.x,coords.yBot)}(changes.length||newScrollPos&&null!=newScrollPos.scrollTop)&&(updated=updateDisplay(changes,!0,newScrollPos&&newScrollPos.scrollTop)),updated||(selectionChanged&&updateSelection(),gutterDirty&&updateGutter()),newScrollPos&&scrollCursorIntoView(),selectionChanged&&restartBlink(),focused&&(updateInput===!0||updateInput!==!1&&selectionChanged)&&resetInput(userSelChange),selectionChanged&&options.matchBrackets&&setTimeout(operation(function(){bracketHighlighted&&(bracketHighlighted(),bracketHighlighted=null),posEq(sel.from,sel.to)&&matchBrackets(!1)}),20);var sc=selectionChanged,cbs=callbacks;textChanged&&options.onChange&&instance&&options.onChange(instance,textChanged),sc&&options.onCursorActivity&&options.onCursorActivity(instance);for(var i=0;cbs.length>i;++i)cbs[i](instance);updated&&options.onUpdate&&options.onUpdate(instance)}function operation(f){return function(){nestedOperation++||startOperation();try{var result=f.apply(this,arguments)}finally{--nestedOperation||endOperation()}return result}}function compoundChange(f){history.startCompound();try{return f()}finally{history.endCompound()}}var options={},defaults=CodeMirror.defaults;for(var opt in defaults)defaults.hasOwnProperty(opt)&&(options[opt]=(givenOptions&&givenOptions.hasOwnProperty(opt)?givenOptions:defaults)[opt]);var input=elt("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em");input.setAttribute("wrap","off"),input.setAttribute("autocorrect","off"),input.setAttribute("autocapitalize","off");var inputDiv=elt("div",[input],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),scrollbarInner=elt("div",null,"CodeMirror-scrollbar-inner"),scrollbar=elt("div",[scrollbarInner],"CodeMirror-scrollbar"),lineDiv=elt("div"),selectionDiv=elt("div",null,null,"position: relative; z-index: -1"),cursor=elt("pre"," ","CodeMirror-cursor"),widthForcer=elt("pre"," ","CodeMirror-cursor","visibility: hidden"),measure=elt("div",null,null,"position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden;"),lineSpace=elt("div",[measure,cursor,widthForcer,selectionDiv,lineDiv],null,"position: relative; z-index: 0"),gutterText=elt("div",null,"CodeMirror-gutter-text"),gutter=elt("div",[gutterText],"CodeMirror-gutter"),mover=elt("div",[gutter,elt("div",[lineSpace],"CodeMirror-lines")],null,"position: relative"),sizer=elt("div",[mover],null,"position: relative"),scroller=elt("div",[sizer],"CodeMirror-scroll");scroller.setAttribute("tabIndex","-1");var wrapper=elt("div",[inputDiv,scrollbar,scroller],"CodeMirror"+(options.lineWrapping?" CodeMirror-wrap":""));place.appendChild?place.appendChild(wrapper):place(wrapper),themeChanged(),keyMapChanged(),ios&&(input.style.width="0px"),webkit||(scroller.draggable=!0),lineSpace.style.outline="none",null!=options.tabindex&&(input.tabIndex=options.tabindex),options.autofocus&&focusInput(),options.gutter||options.lineNumbers||(gutter.style.display="none"),khtml&&(inputDiv.style.height="1px",inputDiv.style.position="absolute"),mac_geLion?(scrollbar.style.zIndex=-2,scrollbar.style.visibility="hidden"):ie_lt8&&(scrollbar.style.minWidth="18px");var poll=new Delayed,highlight=new Delayed,blinker,mode,doc=new BranchChunk([new LeafChunk([new Line("")])]),frontier=0,focused;loadMode();var sel={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},shiftSelecting,lastClick,lastDoubleClick,lastScrollTop=0,draggingText,overwrite=!1,suppressEdits=!1,pasteIncoming=!1,updateInput,userSelChange,changes,textChanged,selectionChanged,gutterDirty,callbacks,displayOffset=0,showingFrom=0,showingTo=0,lastSizeC=0,bracketHighlighted,maxLine=getLine(0),updateMaxLine=!1,maxLineChanged=!0,pollingFast=!1,goalColumn=null;operation(function(){setValue(options.value||""),updateInput=!1})();var history=new History;connect(scroller,"mousedown",operation(onMouseDown)),connect(scroller,"dblclick",operation(onDoubleClick)),connect(lineSpace,"selectstart",e_preventDefault),gecko||connect(scroller,"contextmenu",onContextMenu),connect(scroller,"scroll",onScrollMain),connect(scrollbar,"scroll",onScrollBar),connect(scrollbar,"mousedown",function(){focused&&setTimeout(focusInput,0)});var resizeHandler=connect(window,"resize",function(){wrapper.parentNode?updateDisplay(!0):resizeHandler()},!0);connect(input,"keyup",operation(onKeyUp)),connect(input,"input",fastPoll),connect(input,"keydown",operation(onKeyDown)),connect(input,"keypress",operation(onKeyPress)),connect(input,"focus",onFocus),connect(input,"blur",onBlur),options.dragDrop&&(connect(scroller,"dragstart",onDragStart),connect(scroller,"dragenter",drag_),connect(scroller,"dragover",drag_),connect(scroller,"drop",operation(onDrop))),connect(scroller,"paste",function(){focusInput(),fastPoll()}),connect(input,"paste",function(){pasteIncoming=!0,fastPoll()}),connect(input,"cut",operation(function(){options.readOnly||replaceSelection("")})),khtml&&connect(sizer,"mouseup",function(){document.activeElement==input&&input.blur(),focusInput()});var hasFocus;try{hasFocus=document.activeElement==input}catch(e){}hasFocus||options.autofocus?setTimeout(onFocus,20):onBlur();var instance=wrapper.CodeMirror={getValue:getValue,setValue:operation(setValue),getSelection:getSelection,replaceSelection:operation(replaceSelection),focus:function(){window.focus(),focusInput(),onFocus(),fastPoll()},setOption:function(option,value){var oldVal=options[option];options[option]=value,"mode"==option||"indentUnit"==option?loadMode():"readOnly"==option&&"nocursor"==value?(onBlur(),input.blur()):"readOnly"!=option||value?"theme"==option?themeChanged():"lineWrapping"==option&&oldVal!=value?operation(wrappingChanged)():"tabSize"==option?updateDisplay(!0):"keyMap"==option?keyMapChanged():"tabindex"==option&&(input.tabIndex=value):resetInput(!0),("lineNumbers"==option||"gutter"==option||"firstLineNumber"==option||"theme"==option||"lineNumberFormatter"==option)&&(gutterChanged(),updateDisplay(!0))},getOption:function(option){return options[option]},getMode:function(){return mode},undo:operation(undo),redo:operation(redo),indentLine:operation(function(n,dir){"string"!=typeof dir&&(dir=null==dir?options.smartIndent?"smart":"prev":dir?"add":"subtract"),isLine(n)&&indentLine(n,dir)}),indentSelection:operation(indentSelected),historySize:function(){return{undo:history.done.length,redo:history.undone.length}},clearHistory:function(){history=new History},setHistory:function(histData){history=new History,history.done=histData.done,history.undone=histData.undone},getHistory:function(){function cp(arr){for(var i=0,nw=[],nwelt;arr.length>i;++i){nw.push(nwelt=[]);for(var j=0,elt=arr[i];elt.length>j;++j){var old=[],cur=elt[j];nwelt.push({start:cur.start,added:cur.added,old:old});for(var k=0;cur.old.length>k;++k)old.push(hlText(cur.old[k]))}}return nw}return{done:cp(history.done),undone:cp(history.undone)}},matchBrackets:operation(function(){matchBrackets(!0)}),getTokenAt:operation(function(pos){return pos=clipPos(pos),getLine(pos.line).getTokenAt(mode,getStateBefore(pos.line),options.tabSize,pos.ch)}),getStateAfter:function(line){return line=clipLine(null==line?doc.size-1:line),getStateBefore(line+1)},cursorCoords:function(start,mode){return null==start&&(start=sel.inverted),this.charCoords(start?sel.from:sel.to,mode)},charCoords:function(pos,mode){return pos=clipPos(pos),"local"==mode?localCoords(pos,!1):"div"==mode?localCoords(pos,!0):pageCoords(pos)},coordsChar:function(coords){var off=eltOffset(lineSpace);return coordsChar(coords.x-off.left,coords.y-off.top)},markText:operation(markText),setBookmark:setBookmark,findMarksAt:findMarksAt,setMarker:operation(addGutterMarker),clearMarker:operation(removeGutterMarker),setLineClass:operation(setLineClass),hideLine:operation(function(h){return setLineHidden(h,!0)}),showLine:operation(function(h){return setLineHidden(h,!1)}),onDeleteLine:function(line,f){if("number"==typeof line){if(!isLine(line))return null;line=getLine(line)}return(line.handlers||(line.handlers=[])).push(f),line},lineInfo:lineInfo,getViewport:function(){return{from:showingFrom,to:showingTo}},addWidget:function(pos,node,scroll,vert,horiz){pos=localCoords(clipPos(pos));var top=pos.yBot,left=pos.x;if(node.style.position="absolute",sizer.appendChild(node),"over"==vert)top=pos.y;else if("near"==vert){var vspace=Math.max(scroller.offsetHeight,doc.height*textHeight()),hspace=Math.max(sizer.clientWidth,lineSpace.clientWidth)-paddingLeft();pos.yBot+node.offsetHeight>vspace&&pos.y>node.offsetHeight&&(top=pos.y-node.offsetHeight),left+node.offsetWidth>hspace&&(left=hspace-node.offsetWidth)}node.style.top=top+paddingTop()+"px",node.style.left=node.style.right="","right"==horiz?(left=sizer.clientWidth-node.offsetWidth,node.style.right="0px"):("left"==horiz?left=0:"middle"==horiz&&(left=(sizer.clientWidth-node.offsetWidth)/2),node.style.left=left+paddingLeft()+"px"),scroll&&scrollIntoView(left,top,left+node.offsetWidth,top+node.offsetHeight)},lineCount:function(){return doc.size},clipPos:clipPos,getCursor:function(start){return null==start&&(start=sel.inverted),copyPos(start?sel.from:sel.to)},somethingSelected:function(){return!posEq(sel.from,sel.to)},setCursor:operation(function(line,ch,user){null==ch&&"number"==typeof line.line?setCursor(line.line,line.ch,user):setCursor(line,ch,user)}),setSelection:operation(function(from,to,user){(user?setSelectionUser:setSelection)(clipPos(from),clipPos(to||from))}),getLine:function(line){return isLine(line)?getLine(line).text:void 0},getLineHandle:function(line){return isLine(line)?getLine(line):void 0},setLine:operation(function(line,text){isLine(line)&&replaceRange(text,{line:line,ch:0},{line:line,ch:getLine(line).text.length})}),removeLine:operation(function(line){isLine(line)&&replaceRange("",{line:line,ch:0},clipPos({line:line+1,ch:0}))}),replaceRange:operation(replaceRange),getRange:function(from,to,lineSep){return getRange(clipPos(from),clipPos(to),lineSep)},triggerOnKeyDown:operation(onKeyDown),execCommand:function(cmd){return commands[cmd](instance)},moveH:operation(moveH),deleteH:operation(deleteH),moveV:operation(moveV),toggleOverwrite:function(){overwrite?(overwrite=!1,cursor.className=cursor.className.replace(" CodeMirror-overwrite","")):(overwrite=!0,cursor.className+=" CodeMirror-overwrite")},posFromIndex:function(off){var lineNo=0,ch;return doc.iter(0,doc.size,function(line){var sz=line.text.length+1;return sz>off?(ch=off,!0):(off-=sz,++lineNo,void 0)}),clipPos({line:lineNo,ch:ch})},indexFromPos:function(coords){if(0>coords.line||0>coords.ch)return 0;var index=coords.ch;return doc.iter(0,coords.line,function(line){index+=line.text.length+1}),index},scrollTo:function(x,y){null!=x&&(scroller.scrollLeft=x),null!=y&&(scrollbar.scrollTop=scroller.scrollTop=y),updateDisplay([])},getScrollInfo:function(){return{x:scroller.scrollLeft,y:scrollbar.scrollTop,height:scrollbar.scrollHeight,width:scroller.scrollWidth}},setSize:function(width,height){function interpret(val){return val=String(val),/^\d+$/.test(val)?val+"px":val}null!=width&&(wrapper.style.width=interpret(width)),null!=height&&(scroller.style.height=interpret(height)),instance.refresh()},operation:function(f){return operation(f)()},compoundChange:function(f){return compoundChange(f)},refresh:function(){updateDisplay(!0,null,lastScrollTop),scrollbar.scrollHeight>lastScrollTop&&(scrollbar.scrollTop=lastScrollTop)},getInputField:function(){return input},getWrapperElement:function(){return wrapper},getScrollerElement:function(){return scroller},getGutterElement:function(){return gutter}},maybeTransition,lastStoppedKey=null,prevInput="";TextMarker.prototype.clear=operation(function(){for(var min,max,i=0;this.lines.length>i;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);null!=span.from&&(min=lineNo(line)),null!=span.to&&(max=lineNo(line)),line.markedSpans=removeMarkedSpan(line.markedSpans,span)}null!=min&&changes.push({from:min,to:max+1}),this.lines.length=0,this.explicitlyCleared=!0}),TextMarker.prototype.find=function(){for(var from,to,i=0;this.lines.length>i;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);if(null!=span.from||null!=span.to){var found=lineNo(line);null!=span.from&&(from={line:found,ch:span.from}),null!=span.to&&(to={line:found,ch:span.to})}}return"bookmark"==this.type?from:from&&{from:from,to:to}};var cachedHeight,cachedHeightFor,measurePre,cachedWidth,cachedWidthFor=0,detectingSelectAll,matching={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},nestedOperation=0;for(var ext in extensions)extensions.propertyIsEnumerable(ext)&&!instance.propertyIsEnumerable(ext)&&(instance[ext]=extensions[ext]);for(var i=0;initHooks.length>i;++i)initHooks[i](instance);return instance}function getKeyMap(val){return"string"==typeof val?keyMap[val]:val}function lookupKey(name,extraMap,map,handle,stop){function lookup(map){map=getKeyMap(map);var found=map[name];if(found===!1)return stop&&stop(),!0;if(null!=found&&handle(found))return!0;if(map.nofallthrough)return stop&&stop(),!0;var fallthrough=map.fallthrough;if(null==fallthrough)return!1;if("[object Array]"!=Object.prototype.toString.call(fallthrough))return lookup(fallthrough);for(var i=0,e=fallthrough.length;e>i;++i)if(lookup(fallthrough[i]))return!0;return!1}return extraMap&&lookup(extraMap)?!0:lookup(map)}function isModifierKey(event){var name=keyNames[e_prop(event,"keyCode")];return"Ctrl"==name||"Alt"==name||"Shift"==name||"Mod"==name}function copyState(mode,state){if(state===!0)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];val instanceof Array&&(val=val.concat([])),nstate[n]=val}return nstate}function startState(mode,a1,a2){return mode.startState?mode.startState(a1,a2):!0}function StringStream(string,tabSize){this.pos=this.start=0,this.string=string,this.tabSize=tabSize||8}function MarkedSpan(from,to,marker){this.from=from,this.to=to,this.marker=marker}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;spans.length>i;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;spans.length>i;++i)spans[i]!=span&&(r||(r=[])).push(spans[i]);return r}function markedSpansBefore(old,startCh,endCh){if(old)for(var i=0,nw;old.length>i;++i){var span=old[i],marker=span.marker,startsBefore=null==span.from||(marker.inclusiveLeft?startCh>=span.from:startCh>span.from);if(startsBefore||"bookmark"==marker.type&&span.from==startCh&&span.from!=endCh){var endsAfter=null==span.to||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push({from:span.from,to:endsAfter?null:span.to,marker:marker})}}return nw}function markedSpansAfter(old,endCh){if(old)for(var i=0,nw;old.length>i;++i){var span=old[i],marker=span.marker,endsAfter=null==span.to||(marker.inclusiveRight?span.to>=endCh:span.to>endCh);if(endsAfter||"bookmark"==marker.type&&span.from==endCh){var startsBefore=null==span.from||(marker.inclusiveLeft?endCh>=span.from:endCh>span.from);(nw||(nw=[])).push({from:startsBefore?null:span.from-endCh,to:null==span.to?null:span.to-endCh,marker:marker})}}return nw}function updateMarkedSpans(oldFirst,oldLast,startCh,endCh,newText){if(!oldFirst&&!oldLast)return newText;var first=markedSpansBefore(oldFirst,startCh),last=markedSpansAfter(oldLast,endCh),sameLine=1==newText.length,offset=lst(newText).length+(sameLine?startCh:0);if(first)for(var i=0;first.length>i;++i){var span=first[i];if(null==span.to){var found=getMarkedSpanFor(last,span.marker);found?sameLine&&(span.to=null==found.to?null:found.to+offset):span.to=startCh}}if(last)for(var i=0;last.length>i;++i){var span=last[i];if(null!=span.to&&(span.to+=offset),null==span.from){var found=getMarkedSpanFor(first,span.marker);found||(span.from=offset,sameLine&&(first||(first=[])).push(span))}else span.from+=offset,sameLine&&(first||(first=[])).push(span)}var newMarkers=[newHL(newText[0],first)];if(!sameLine){var gap=newText.length-2,gapMarkers;if(gap>0&&first)for(var i=0;first.length>i;++i)null==first[i].to&&(gapMarkers||(gapMarkers=[])).push({from:null,to:null,marker:first[i].marker});for(var i=0;gap>i;++i)newMarkers.push(newHL(newText[i+1],gapMarkers));newMarkers.push(newHL(lst(newText),last))}return newMarkers}function hlText(val){return"string"==typeof val?val:val.text}function hlSpans(val){if("string"==typeof val)return null;for(var spans=val.markedSpans,out=null,i=0;spans.length>i;++i)spans[i].marker.explicitlyCleared?out||(out=spans.slice(0,i)):out&&out.push(spans[i]);return out?out.length?out:null:spans}function newHL(text,spans){return spans?{text:text,markedSpans:spans}:text}function detachMarkedSpans(line){var spans=line.markedSpans;if(spans){for(var i=0;spans.length>i;++i){var lines=spans[i].marker.lines,ix=indexOf(lines,line);lines.splice(ix,1)}line.markedSpans=null}}function attachMarkedSpans(line,spans){if(spans){for(var i=0;spans.length>i;++i)var marker=spans[i].marker.lines.push(line);line.markedSpans=spans}}function Line(text,markedSpans){this.text=text,this.height=1,attachMarkedSpans(this,markedSpans)}function LeafChunk(lines){this.lines=lines,this.parent=null;for(var i=0,e=lines.length,height=0;e>i;++i)lines[i].parent=this,height+=lines[i].height;this.height=height}function BranchChunk(children){this.children=children;for(var size=0,height=0,i=0,e=children.length;e>i;++i){var ch=children[i];size+=ch.chunkSize(),height+=ch.height,ch.parent=this}this.size=size,this.height=height,this.parent=null}function getLineAt(chunk,n){for(;!chunk.lines;)for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(sz>n){chunk=child;break}n-=sz}return chunk.lines[n]}function lineNo(line){if(null==line.parent)return null;for(var cur=line.parent,no=indexOf(cur.lines,line),chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent)for(var i=0,e=chunk.children.length;chunk.children[i]!=cur;++i)no+=chunk.children[i].chunkSize();return no}function lineAtHeight(chunk,h){var n=0;outer:do{for(var i=0,e=chunk.children.length;e>i;++i){var child=chunk.children[i],ch=child.height;if(ch>h){chunk=child;continue outer}h-=ch,n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0,e=chunk.lines.length;e>i;++i){var line=chunk.lines[i],lh=line.height;if(lh>h)break;h-=lh}return n+i}function heightAtLine(chunk,n){var h=0;outer:do{for(var i=0,e=chunk.children.length;e>i;++i){var child=chunk.children[i],sz=child.chunkSize();if(sz>n){chunk=child;continue outer}n-=sz,h+=child.height}return h}while(!chunk.lines);for(var i=0;n>i;++i)h+=chunk.lines[i].height;return h}function History(){this.time=0,this.done=[],this.undone=[],this.compound=0,this.closed=!1}function stopMethod(){e_stop(this)}function addStop(event){return event.stop||(event.stop=stopMethod),event}function e_preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function e_stopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function e_stop(e){e_preventDefault(e),e_stopPropagation(e)}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;return null==b&&(1&e.button?b=1:2&e.button?b=3:4&e.button&&(b=2)),mac&&e.ctrlKey&&1==b&&(b=3),b}function e_prop(e,prop){var overridden=e.override&&e.override.hasOwnProperty(prop);return overridden?e.override[prop]:e[prop]}function connect(node,type,handler,disconnect){if("function"==typeof node.addEventListener){if(node.addEventListener(type,handler,!1),disconnect)return function(){node.removeEventListener(type,handler,!1)}}else{var wrapHandler=function(event){handler(event||window.event)};if(node.attachEvent("on"+type,wrapHandler),disconnect)return function(){node.detachEvent("on"+type,wrapHandler)}}}function Delayed(){this.id=null}function countColumn(string,end,tabSize){null==end&&(end=string.search(/[^\s\u00a0]/),-1==end&&(end=string.length));for(var i=0,n=0;end>i;++i)"	"==string.charAt(i)?n+=tabSize-n%tabSize:++n;return n}function eltOffset(node,screen){try{var box=node.getBoundingClientRect();box={top:box.top,left:box.left}}catch(e){box={top:0,left:0}}if(!screen)if(null==window.pageYOffset){var t=document.documentElement||document.body.parentNode;null==t.scrollTop&&(t=document.body),box.top+=t.scrollTop,box.left+=t.scrollLeft}else box.top+=window.pageYOffset,box.left+=window.pageXOffset;return box}function eltText(node){return node.textContent||node.innerText||node.nodeValue||""}function spaceStr(n){for(;n>=spaceStrs.length;)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function selectInput(node){ios?(node.selectionStart=0,node.selectionEnd=node.value.length):node.select()}function posEq(a,b){return a.line==b.line&&a.ch==b.ch}function posLess(a,b){return b.line>a.line||a.line==b.line&&b.ch>a.ch}function copyPos(x){return{line:x.line,ch:x.ch}}function elt(tag,content,className,style){var e=document.createElement(tag);if(className&&(e.className=className),style&&(e.style.cssText=style),"string"==typeof content)setTextContent(e,content);else if(content)for(var i=0;content.length>i;++i)e.appendChild(content[i]);return e}function removeChildren(e){return e.innerHTML="",e}function removeChildrenAndAdd(parent,e){removeChildren(parent).appendChild(e)}function setTextContent(e,str){ie_lt9?(e.innerHTML="",e.appendChild(document.createTextNode(str))):e.textContent=str}function editEnd(from,to){if(!to)return 0;if(!from)return to.length;for(var i=from.length,j=to.length;i>=0&&j>=0&&from.charAt(i)==to.charAt(j);--i,--j);return j+1}function indexOf(collection,elt){if(collection.indexOf)return collection.indexOf(elt);for(var i=0,e=collection.length;e>i;++i)if(collection[i]==elt)return i;return-1}function isWordChar(ch){return/\w/.test(ch)||ch.toUpperCase()!=ch.toLowerCase()||/[\u4E00-\u9FA5]/.test(ch)}CodeMirror.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,smartIndent:!0,tabSize:4,keyMap:"default",extraKeys:null,electricChars:!0,autoClearEmptyLines:!1,onKeyEvent:null,onDragEvent:null,lineWrapping:!1,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,readOnly:!1,dragDrop:!0,onChange:null,onCursorActivity:null,onViewportChange:null,onGutterClick:null,onUpdate:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:!1,cursorBlinkRate:530,workTime:100,workDelay:200,pollInterval:100,undoDepth:40,tabindex:null,autofocus:null,lineNumberFormatter:function(integer){return integer
}};var ios=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),mac=ios||/Mac/.test(navigator.platform),win=/Win/.test(navigator.platform),modes=CodeMirror.modes={},mimeModes=CodeMirror.mimeModes={};CodeMirror.defineMode=function(name,mode){if(CodeMirror.defaults.mode||"null"==name||(CodeMirror.defaults.mode=name),arguments.length>2){mode.dependencies=[];for(var i=2;arguments.length>i;++i)mode.dependencies.push(arguments[i])}modes[name]=mode},CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec},CodeMirror.resolveMode=function(spec){if("string"==typeof spec&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return CodeMirror.resolveMode("application/xml");return"string"==typeof spec?{name:spec}:spec||{name:"null"}},CodeMirror.getMode=function(options,spec){var spec=CodeMirror.resolveMode(spec),mfactory=modes[spec.name];if(!mfactory)return CodeMirror.getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts)exts.hasOwnProperty(prop)&&(modeObj[prop]=exts[prop])}return modeObj.name=spec.name,modeObj},CodeMirror.listModes=function(){var list=[];for(var m in modes)modes.propertyIsEnumerable(m)&&list.push(m);return list},CodeMirror.listMIMEs=function(){var list=[];for(var m in mimeModes)mimeModes.propertyIsEnumerable(m)&&list.push({mime:m,mode:mimeModes[m]});return list};var extensions=CodeMirror.extensions={};CodeMirror.defineExtension=function(name,func){extensions[name]=func};var initHooks=[];CodeMirror.defineInitHook=function(f){initHooks.push(f)};var modeExtensions=CodeMirror.modeExtensions={};CodeMirror.extendMode=function(mode,properties){var exts=modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={};for(var prop in properties)properties.hasOwnProperty(prop)&&(exts[prop]=properties[prop])};var commands=CodeMirror.commands={selectAll:function(cm){cm.setSelection({line:0,ch:0},{line:cm.lineCount()-1})},killLine:function(cm){var from=cm.getCursor(!0),to=cm.getCursor(!1),sel=!posEq(from,to);sel||cm.getLine(from.line).length!=from.ch?cm.replaceRange("",from,sel?to:{line:from.line}):cm.replaceRange("",from,{line:from.line+1,ch:0})},deleteLine:function(cm){var l=cm.getCursor().line;cm.replaceRange("",{line:l,ch:0},{line:l})},undo:function(cm){cm.undo()},redo:function(cm){cm.redo()},goDocStart:function(cm){cm.setCursor(0,0,!0)},goDocEnd:function(cm){cm.setSelection({line:cm.lineCount()-1},null,!0)},goLineStart:function(cm){cm.setCursor(cm.getCursor().line,0,!0)},goLineStartSmart:function(cm){var cur=cm.getCursor(),text=cm.getLine(cur.line),firstNonWS=Math.max(0,text.search(/\S/));cm.setCursor(cur.line,firstNonWS>=cur.ch&&cur.ch?0:firstNonWS,!0)},goLineEnd:function(cm){cm.setSelection({line:cm.getCursor().line},null,!0)},goLineUp:function(cm){cm.moveV(-1,"line")},goLineDown:function(cm){cm.moveV(1,"line")},goPageUp:function(cm){cm.moveV(-1,"page")},goPageDown:function(cm){cm.moveV(1,"page")},goCharLeft:function(cm){cm.moveH(-1,"char")},goCharRight:function(cm){cm.moveH(1,"char")},goColumnLeft:function(cm){cm.moveH(-1,"column")},goColumnRight:function(cm){cm.moveH(1,"column")},goWordLeft:function(cm){cm.moveH(-1,"word")},goWordRight:function(cm){cm.moveH(1,"word")},delCharLeft:function(cm){cm.deleteH(-1,"char")},delCharRight:function(cm){cm.deleteH(1,"char")},delWordLeft:function(cm){cm.deleteH(-1,"word")},delWordRight:function(cm){cm.deleteH(1,"word")},indentAuto:function(cm){cm.indentSelection("smart")},indentMore:function(cm){cm.indentSelection("add")},indentLess:function(cm){cm.indentSelection("subtract")},insertTab:function(cm){cm.replaceSelection("	","end")},defaultTab:function(cm){cm.somethingSelected()?cm.indentSelection("add"):cm.replaceSelection("	","end")},transposeChars:function(cm){var cur=cm.getCursor(),line=cm.getLine(cur.line);cur.ch>0&&line.length-1>cur.ch&&cm.replaceRange(line.charAt(cur.ch)+line.charAt(cur.ch-1),{line:cur.line,ch:cur.ch-1},{line:cur.line,ch:cur.ch+1})},newlineAndIndent:function(cm){cm.replaceSelection("\n","end"),cm.indentLine(cm.getCursor().line)},toggleOverwrite:function(cm){cm.toggleOverwrite()}},keyMap=CodeMirror.keyMap={};keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharRight",Backspace:"delCharLeft",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordLeft","Ctrl-Delete":"delWordRight","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordLeft","Ctrl-Alt-Backspace":"delWordRight","Alt-Delete":"delWordRight","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},keyMap["default"]=mac?keyMap.macDefault:keyMap.pcDefault,keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageUp","Shift-Ctrl-V":"goPageDown","Ctrl-D":"delCharRight","Ctrl-H":"delCharLeft","Alt-D":"delWordRight","Alt-Backspace":"delWordLeft","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},CodeMirror.isModifierKey=isModifierKey,CodeMirror.fromTextArea=function(textarea,options){function save(){textarea.value=instance.getValue()}if(options||(options={}),options.value=textarea.value,!options.tabindex&&textarea.tabindex&&(options.tabindex=textarea.tabindex),null==options.autofocus){var hasFocus=document.body;try{hasFocus=document.activeElement}catch(e){}options.autofocus=hasFocus==textarea||null!=textarea.getAttribute("autofocus")&&hasFocus==document.body}if(textarea.form){var rmSubmit=connect(textarea.form,"submit",save,!0);if("function"==typeof textarea.form.submit){var realSubmit=textarea.form.submit;textarea.form.submit=function wrappedSubmit(){save(),textarea.form.submit=realSubmit,textarea.form.submit(),textarea.form.submit=wrappedSubmit}}}textarea.style.display="none";var instance=CodeMirror(function(node){textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);return instance.save=save,instance.getTextArea=function(){return textarea},instance.toTextArea=function(){save(),textarea.parentNode.removeChild(instance.getWrapperElement()),textarea.style.display="",textarea.form&&(rmSubmit(),"function"==typeof textarea.form.submit&&(textarea.form.submit=realSubmit))},instance};var gecko=/gecko\/\d{7}/i.test(navigator.userAgent),ie=/MSIE \d/.test(navigator.userAgent),ie_lt8=/MSIE [1-7]\b/.test(navigator.userAgent),ie_lt9=/MSIE [1-8]\b/.test(navigator.userAgent),quirksMode=ie&&5==document.documentMode,webkit=/WebKit\//.test(navigator.userAgent),chrome=/Chrome\//.test(navigator.userAgent),opera=/Opera\//.test(navigator.userAgent),safari=/Apple Computer/.test(navigator.vendor),khtml=/KHTML\//.test(navigator.userAgent),mac_geLion=/Mac OS X 10\D([7-9]|\d\d)\D/.test(navigator.userAgent);CodeMirror.copyState=copyState,CodeMirror.startState=startState,CodeMirror.innerMode=function(mode,state){for(;mode.innerMode;){var info=mode.innerMode(state);state=info.state,mode=info.mode}return info||{mode:mode,state:state}},StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.string.length>this.pos?this.string.charAt(this.pos++):void 0},eat:function(match){var ch=this.string.charAt(this.pos);if("string"==typeof match)var ok=ch==match;else var ok=ch&&(match.test?match.test(ch):match(ch));return ok?(++this.pos,ch):void 0},eatWhile:function(match){for(var start=this.pos;this.eat(match););return this.pos>start},eatSpace:function(){for(var start=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>start},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ch){var found=this.string.indexOf(ch,this.pos);return found>-1?(this.pos=found,!0):void 0},backUp:function(n){this.pos-=n},column:function(){return countColumn(this.string,this.start,this.tabSize)},indentation:function(){return countColumn(this.string,null,this.tabSize)},match:function(pattern,consume,caseInsensitive){if("string"!=typeof pattern){var match=this.string.slice(this.pos).match(pattern);return match&&match.index>0?null:(match&&consume!==!1&&(this.pos+=match[0].length),match)}var cased=function(str){return caseInsensitive?str.toLowerCase():str};return cased(this.string).indexOf(cased(pattern),this.pos)==this.pos?(consume!==!1&&(this.pos+=pattern.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},CodeMirror.StringStream=StringStream;var eolSpanContent=" ";gecko||ie&&!ie_lt8?eolSpanContent="​":opera&&(eolSpanContent=""),Line.prototype={update:function(text,markedSpans){this.text=text,this.stateAfter=this.styles=null,detachMarkedSpans(this),attachMarkedSpans(this,markedSpans)},highlight:function(mode,state,tabSize){var stream=new StringStream(this.text,tabSize),st=this.styles||(this.styles=[]),pos=st.length=0;for(""==this.text&&mode.blankLine&&mode.blankLine(state);!stream.eol();){var style=mode.token(stream,state),substr=stream.current();if(stream.start=stream.pos,pos&&st[pos-1]==style?st[pos-2]+=substr:substr&&(st[pos++]=substr,st[pos++]=style),stream.pos>5e3){st[pos++]=this.text.slice(stream.pos),st[pos++]=null;break}}},process:function(mode,state,tabSize){var stream=new StringStream(this.text,tabSize);for(""==this.text&&mode.blankLine&&mode.blankLine(state);!stream.eol()&&5e3>=stream.pos;)mode.token(stream,state),stream.start=stream.pos},getTokenAt:function(mode,state,tabSize,ch){for(var txt=this.text,stream=new StringStream(txt,tabSize);ch>stream.pos&&!stream.eol();){stream.start=stream.pos;var style=mode.token(stream,state)}return{start:stream.start,end:stream.pos,string:stream.current(),className:style||null,state:state}},indentation:function(tabSize){return countColumn(this.text,null,tabSize)},getContent:function(tabSize,wrapAt,compensateForWrapping){function span_(html,text,style){if(text){if(first&&ie&&" "==text.charAt(0)&&(text=" "+text.slice(1)),first=!1,specials.test(text))for(var content=document.createDocumentFragment(),pos=0;;){specials.lastIndex=pos;var m=specials.exec(text),skipped=m?m.index-pos:text.length-pos;if(skipped&&(content.appendChild(document.createTextNode(text.slice(pos,pos+skipped))),col+=skipped),!m)break;if(pos+=skipped+1,"	"==m[0]){var tabWidth=tabSize-col%tabSize;content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab")),col+=tabWidth}else{var token=elt("span","•","cm-invalidchar");token.title="\\u"+m[0].charCodeAt(0).toString(16),content.appendChild(token),col+=1}}else{col+=text.length;var content=document.createTextNode(text)}style?html.appendChild(elt("span",[content],style)):html.appendChild(content)}}function styleToClass(style){return style?"cm-"+style.replace(/ +/g," cm-"):null}var first=!0,col=0,specials=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g,pre=elt("pre"),span=span_;if(null!=wrapAt){var outPos=0,anchor=pre.anchor=elt("span");span=function(html,text,style){var l=text.length;if(wrapAt>=outPos&&outPos+l>wrapAt){var cut=wrapAt-outPos;if(cut&&(span_(html,text.slice(0,cut),style),compensateForWrapping)){var view=text.slice(cut-1,cut+1);spanAffectsWrapping.test(view)?html.appendChild(elt("wbr")):!ie_lt8&&/\w\w/.test(view)&&html.appendChild(document.createTextNode("‍"))}html.appendChild(anchor),span_(anchor,opera?text.slice(cut,cut+1):text.slice(cut),style),opera&&span_(html,text.slice(cut+1),style),wrapAt--,outPos+=l}else outPos+=l,span_(html,text,style),outPos==wrapAt&&outPos==len?(setTextContent(anchor,eolSpanContent),html.appendChild(anchor)):outPos>wrapAt+10&&/\s/.test(text)&&(span=function(){})}}var st=this.styles,allText=this.text,marked=this.markedSpans,len=allText.length;if(allText||null!=wrapAt)if(marked&&marked.length){marked.sort(function(a,b){return a.from-b.from});for(var pos=0,i=0,text="",style,sg=0,nextChange=marked[0].from||0,marks=[],markpos=0,advanceMarks=function(){for(var m;marked.length>markpos&&((m=marked[markpos]).from==pos||null==m.from);)"range"==m.marker.type&&marks.push(m),++markpos;nextChange=marked.length>markpos?marked[markpos].from:1/0;for(var i=0;marks.length>i;++i){var to=marks[i].to;null==to&&(to=1/0),to==pos?marks.splice(i--,1):nextChange=Math.min(to,nextChange)}},m=0;len>pos;){nextChange==pos&&advanceMarks();for(var upto=Math.min(len,nextChange);;){if(text){for(var end=pos+text.length,appliedStyle=style,j=0;marks.length>j;++j){var mark=marks[j];appliedStyle=(appliedStyle?appliedStyle+" ":"")+mark.marker.style,mark.marker.endStyle&&mark.to===Math.min(end,upto)&&(appliedStyle+=" "+mark.marker.endStyle),mark.marker.startStyle&&mark.from===pos&&(appliedStyle+=" "+mark.marker.startStyle)}if(span(pre,end>upto?text.slice(0,upto-pos):text,appliedStyle),end>=upto){text=text.slice(upto-pos),pos=upto;break}pos=end}text=st[i++],style=styleToClass(st[i++])}}}else for(var i=0,ch=0;len>ch;i+=2){var str=st[i],style=st[i+1],l=str.length;ch+l>len&&(str=str.slice(0,len-ch)),ch+=l,span(pre,str,styleToClass(style))}else span(pre," ");return pre},cleanUp:function(){this.parent=null,detachMarkedSpans(this)}},LeafChunk.prototype={chunkSize:function(){return this.lines.length},remove:function(at,n,callbacks){for(var i=at,e=at+n;e>i;++i){var line=this.lines[i];if(this.height-=line.height,line.cleanUp(),line.handlers)for(var j=0;line.handlers.length>j;++j)callbacks.push(line.handlers[j])}this.lines.splice(at,n)},collapse:function(lines){lines.splice.apply(lines,[lines.length,0].concat(this.lines))},insertHeight:function(at,lines,height){this.height+=height,this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0,e=lines.length;e>i;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;e>at;++at)if(op(this.lines[at]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},remove:function(at,n,callbacks){this.size-=n;for(var i=0;this.children.length>i;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var rm=Math.min(n,sz-at),oldHeight=child.height;if(child.remove(at,rm,callbacks),this.height-=oldHeight-child.height,sz==rm&&(this.children.splice(i--,1),child.parent=null),0==(n-=rm))break;at=0}else at-=sz}if(25>this.size-n){var lines=[];this.collapse(lines),this.children=[new LeafChunk(lines)],this.children[0].parent=this}},collapse:function(lines){for(var i=0,e=this.children.length;e>i;++i)this.children[i].collapse(lines)},insert:function(at,lines){for(var height=0,i=0,e=lines.length;e>i;++i)height+=lines[i].height;this.insertHeight(at,lines,height)},insertHeight:function(at,lines,height){this.size+=lines.length,this.height+=height;for(var i=0,e=this.children.length;e>i;++i){var child=this.children[i],sz=child.chunkSize();if(sz>=at){if(child.insertHeight(at,lines,height),child.lines&&child.lines.length>50){for(;child.lines.length>50;){var spilled=child.lines.splice(child.lines.length-25,25),newleaf=new LeafChunk(spilled);child.height-=newleaf.height,this.children.splice(i+1,0,newleaf),newleaf.parent=this}this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(!(10>=this.children.length)){var me=this;do{var spilled=me.children.splice(me.children.length-5,5),sibling=new BranchChunk(spilled);if(me.parent){me.size-=sibling.size,me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}else{var copy=new BranchChunk(me.children);copy.parent=me,me.children=[copy,sibling],me=copy}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()}},iter:function(from,to,op){this.iterN(from,to-from,op)},iterN:function(at,n,op){for(var i=0,e=this.children.length;e>i;++i){var child=this.children[i],sz=child.chunkSize();if(sz>at){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return!0;if(0==(n-=used))break;at=0}else at-=sz}}},History.prototype={addChange:function(start,added,old){this.undone.length=0;var time=+new Date,cur=lst(this.done),last=cur&&lst(cur),dtime=time-this.time;if(cur&&!this.closed&&this.compound)cur.push({start:start,added:added,old:old});else if(dtime>400||!last||this.closed||last.start>start+old.length||start>last.start+last.added)this.done.push([{start:start,added:added,old:old}]),this.closed=!1;else{for(var startBefore=Math.max(0,last.start-start),endAfter=Math.max(0,start+old.length-(last.start+last.added)),i=startBefore;i>0;--i)last.old.unshift(old[i-1]);for(var i=endAfter;i>0;--i)last.old.push(old[old.length-i]);startBefore&&(last.start=start),last.added+=added-(old.length-startBefore-endAfter)}this.time=time},startCompound:function(){this.compound++||(this.closed=!0)},endCompound:function(){--this.compound||(this.closed=!0)}},CodeMirror.e_stop=e_stop,CodeMirror.e_preventDefault=e_preventDefault,CodeMirror.e_stopPropagation=e_stopPropagation,CodeMirror.connect=connect,Delayed.prototype={set:function(ms,f){clearTimeout(this.id),this.id=setTimeout(f,ms)}};var Pass=CodeMirror.Pass={toString:function(){return"CodeMirror.Pass"}},dragAndDrop=function(){if(ie_lt9)return!1;var div=elt("div");return"draggable"in div||"dragDrop"in div}(),lineSep=function(){var te=elt("textarea");return te.value="foo\nbar",te.value.indexOf("\r")>-1?"\r\n":"\n"}(),spanAffectsWrapping=/^$/;gecko?spanAffectsWrapping=/$'/:safari?spanAffectsWrapping=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:chrome&&(spanAffectsWrapping=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);var spaceStrs=[""],splitLines=3!="\n\nb".split(/\n/).length?function(string){for(var pos=0,result=[],l=string.length;l>=pos;){var nl=string.indexOf("\n",pos);-1==nl&&(nl=string.length);var line=string.slice(pos,"\r"==string.charAt(nl-1)?nl-1:nl),rt=line.indexOf("\r");-1!=rt?(result.push(line.slice(0,rt)),pos+=rt+1):(result.push(line),pos=nl+1)}return result}:function(string){return string.split(/\r\n?|\n/)};CodeMirror.splitLines=splitLines;var hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return!1}}:function(te){try{var range=te.ownerDocument.selection.createRange()}catch(e){}return range&&range.parentElement()==te?0!=range.compareEndPoints("StartToEnd",range):!1};CodeMirror.defineMode("null",function(){return{token:function(stream){stream.skipToEnd()}}}),CodeMirror.defineMIME("text/plain","null");var keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};return CodeMirror.keyNames=keyNames,function(){for(var i=0;10>i;i++)keyNames[i+48]=String(i);for(var i=65;90>=i;i++)keyNames[i]=String.fromCharCode(i);for(var i=1;12>=i;i++)keyNames[i+111]=keyNames[i+63235]="F"+i}(),CodeMirror.version="2.35",CodeMirror}(),CodeMirror.defineMode("javascript",function(config,parserConfig){function chain(stream,state,f){return state.tokenize=f,f(stream,state)}function nextUntilUnescaped(stream,end){for(var escaped=!1,next;null!=(next=stream.next());){if(next==end&&!escaped)return!1;escaped=!escaped&&"\\"==next}return escaped}function ret(tp,style,cont){return type=tp,content=cont,style}function jsTokenBase(stream,state){var ch=stream.next();if('"'==ch||"'"==ch)return chain(stream,state,jsTokenString(ch));if(/[\[\]{}\(\),;\:\.]/.test(ch))return ret(ch);if("0"==ch&&stream.eat(/x/i))return stream.eatWhile(/[\da-f]/i),ret("number","number");if(/\d/.test(ch)||"-"==ch&&stream.eat(/\d/))return stream.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),ret("number","number");if("/"==ch)return stream.eat("*")?chain(stream,state,jsTokenComment):stream.eat("/")?(stream.skipToEnd(),ret("comment","comment")):"operator"==state.lastType||"keyword c"==state.lastType||/^[\[{}\(,;:]$/.test(state.lastType)?(nextUntilUnescaped(stream,"/"),stream.eatWhile(/[gimy]/),ret("regexp","string-2")):(stream.eatWhile(isOperatorChar),ret("operator",null,stream.current()));if("#"==ch)return stream.skipToEnd(),ret("error","error");if(isOperatorChar.test(ch))return stream.eatWhile(isOperatorChar),ret("operator",null,stream.current());stream.eatWhile(/[\w\$_]/);var word=stream.current(),known=keywords.propertyIsEnumerable(word)&&keywords[word];return known&&"."!=state.lastType?ret(known.type,known.style,word):ret("variable","variable",word)}function jsTokenString(quote){return function(stream,state){return nextUntilUnescaped(stream,quote)||(state.tokenize=jsTokenBase),ret("string","string")}}function jsTokenComment(stream,state){for(var maybeEnd=!1,ch;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=jsTokenBase;break}maybeEnd="*"==ch}return ret("comment","comment")}function JSLexical(indented,column,type,align,prev,info){this.indented=indented,this.column=column,this.type=type,this.prev=prev,this.info=info,null!=align&&(this.align=align)}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return!0}function parseJS(state,style,type,content,stream){var cc=state.cc;for(cx.state=state,cx.stream=stream,cx.marked=null,cx.cc=cc,state.lexical.hasOwnProperty("align")||(state.lexical.align=!0);;){var combinator=cc.length?cc.pop():jsonMode?expression:statement;if(combinator(type,content)){for(;cc.length&&cc[cc.length-1].lex;)cc.pop()();return cx.marked?cx.marked:"variable"==type&&inScope(state,content)?"variable-2":style}}}function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){return pass.apply(null,arguments),!0}function register(varname){var state=cx.state;if(state.context){cx.marked="def";for(var v=state.localVars;v;v=v.next)if(v.name==varname)return;state.localVars={name:varname,next:state.localVars}}}function pushcontext(){cx.state.context={prev:cx.state.context,vars:cx.state.localVars},cx.state.localVars=defaultVars}function popcontext(){cx.state.localVars=cx.state.context.vars,cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state;state.lexical=new JSLexical(state.indented,cx.stream.column(),type,null,state.lexical,info)};return result.lex=!0,result}function poplex(){var state=cx.state;state.lexical.prev&&(")"==state.lexical.type&&(state.indented=state.lexical.indented),state.lexical=state.lexical.prev)}function expect(wanted){return function expecting(type){return type==wanted?cont():";"==wanted?pass():cont(arguments.callee)}}function statement(type){return"var"==type?cont(pushlex("vardef"),vardef1,expect(";"),poplex):"keyword a"==type?cont(pushlex("form"),expression,statement,poplex):"keyword b"==type?cont(pushlex("form"),statement,poplex):"{"==type?cont(pushlex("}"),block,poplex):";"==type?cont():"function"==type?cont(functiondef):"for"==type?cont(pushlex("form"),expect("("),pushlex(")"),forspec1,expect(")"),poplex,statement,poplex):"variable"==type?cont(pushlex("stat"),maybelabel):"switch"==type?cont(pushlex("form"),expression,pushlex("}","switch"),expect("{"),block,poplex,poplex):"case"==type?cont(expression,expect(":")):"default"==type?cont(expect(":")):"catch"==type?cont(pushlex("form"),pushcontext,expect("("),funarg,expect(")"),statement,poplex,popcontext):pass(pushlex("stat"),expression,expect(";"),poplex)}function expression(type){return atomicTypes.hasOwnProperty(type)?cont(maybeoperator):"function"==type?cont(functiondef):"keyword c"==type?cont(maybeexpression):"("==type?cont(pushlex(")"),maybeexpression,expect(")"),poplex,maybeoperator):"operator"==type?cont(expression):"["==type?cont(pushlex("]"),commasep(expression,"]"),poplex,maybeoperator):"{"==type?cont(pushlex("}"),commasep(objprop,"}"),poplex,maybeoperator):cont()}function maybeexpression(type){return type.match(/[;\}\)\],]/)?pass():pass(expression)}function maybeoperator(type,value){if("operator"==type&&/\+\+|--/.test(value))return cont(maybeoperator);if("operator"==type&&"?"==value)return cont(expression,expect(":"),expression);if(";"!=type)return"("==type?cont(pushlex(")"),commasep(expression,")"),poplex,maybeoperator):"."==type?cont(property,maybeoperator):"["==type?cont(pushlex("]"),expression,expect("]"),poplex,maybeoperator):void 0}function maybelabel(type){return":"==type?cont(poplex,statement):pass(maybeoperator,expect(";"),poplex)}function property(type){return"variable"==type?(cx.marked="property",cont()):void 0}function objprop(type){return"variable"==type&&(cx.marked="property"),atomicTypes.hasOwnProperty(type)?cont(expect(":"),expression):void 0}function commasep(what,end){function proceed(type){return","==type?cont(what,proceed):type==end?cont():cont(expect(end))}return function commaSeparated(type){return type==end?cont():pass(what,proceed)}}function block(type){return"}"==type?cont():pass(statement,block)}function maybetype(type){return":"==type?cont(typedef):pass()}function typedef(type){return"variable"==type?(cx.marked="variable-3",cont()):pass()}function vardef1(type,value){return"variable"==type?(register(value),isTS?cont(maybetype,vardef2):cont(vardef2)):pass()}function vardef2(type,value){return"="==value?cont(expression,vardef2):","==type?cont(vardef1):void 0}function forspec1(type){return"var"==type?cont(vardef1,expect(";"),forspec2):";"==type?cont(forspec2):"variable"==type?cont(formaybein):cont(forspec2)}function formaybein(type,value){return"in"==value?cont(expression):cont(maybeoperator,forspec2)}function forspec2(type,value){return";"==type?cont(forspec3):"in"==value?cont(expression):cont(expression,expect(";"),forspec3)}function forspec3(type){")"!=type&&cont(expression)}function functiondef(type,value){return"variable"==type?(register(value),cont(functiondef)):"("==type?cont(pushlex(")"),pushcontext,commasep(funarg,")"),poplex,statement,popcontext):void 0}function funarg(type,value){return"variable"==type?(register(value),isTS?cont(maybetype):cont()):void 0}var indentUnit=config.indentUnit,jsonMode=parserConfig.json,isTS=parserConfig.typescript,keywords=function(){function kw(type){return{type:type,style:"keyword"}}var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c"),operator=kw("operator"),atom={type:"atom",style:"atom"},jsKeywords={"if":A,"while":A,"with":A,"else":B,"do":B,"try":B,"finally":B,"return":C,"break":C,"continue":C,"new":C,"delete":C,"throw":C,"var":kw("var"),"const":kw("var"),let:kw("var"),"function":kw("function"),"catch":kw("catch"),"for":kw("for"),"switch":kw("switch"),"case":kw("case"),"default":kw("default"),"in":operator,"typeof":operator,"instanceof":operator,"true":atom,"false":atom,"null":atom,undefined:atom,NaN:atom,Infinity:atom};if(isTS){var type={type:"variable",style:"variable-3"},tsKeywords={"interface":kw("interface"),"class":kw("class"),"extends":kw("extends"),constructor:kw("constructor"),"public":kw("public"),"private":kw("private"),"protected":kw("protected"),"static":kw("static"),"super":kw("super"),string:type,number:type,bool:type,any:type};for(var attr in tsKeywords)jsKeywords[attr]=tsKeywords[attr]}return jsKeywords}(),isOperatorChar=/[+\-*&%=<>!?|]/,type,content,atomicTypes={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},cx={state:null,column:null,marked:null,cc:null},defaultVars={name:"this",next:{name:"arguments"}};return poplex.lex=!0,{startState:function(basecolumn){return{tokenize:jsTokenBase,lastType:null,cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",!1),localVars:parserConfig.localVars,context:parserConfig.localVars&&{vars:parserConfig.localVars},indented:0}},token:function(stream,state){if(stream.sol()&&(state.lexical.hasOwnProperty("align")||(state.lexical.align=!1),state.indented=stream.indentation()),stream.eatSpace())return null;var style=state.tokenize(stream,state);return"comment"==type?style:(state.lastType=type,parseJS(state,style,type,content,stream))},indent:function(state,textAfter){if(state.tokenize==jsTokenComment)return CodeMirror.Pass;if(state.tokenize!=jsTokenBase)return 0;var firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;"stat"==lexical.type&&"}"==firstChar&&(lexical=lexical.prev);var type=lexical.type,closing=firstChar==type;return"vardef"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?4:0):"form"==type&&"{"==firstChar?lexical.indented:"form"==type?lexical.indented+indentUnit:"stat"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?indentUnit:0):"switch"!=lexical.info||closing?lexical.align?lexical.column+(closing?0:1):lexical.indented+(closing?0:indentUnit):lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit)},electricChars:":{}"}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMode("clike",function(config,parserConfig){function tokenBase(stream,state){var ch=stream.next();if(hooks[ch]){var result=hooks[ch](stream,state);if(result!==!1)return result}if('"'==ch||"'"==ch)return state.tokenize=tokenString(ch),state.tokenize(stream,state);if(/[\[\]{}\(\),;\:\.]/.test(ch))return curPunc=ch,null;if(/\d/.test(ch))return stream.eatWhile(/[\w\.]/),"number";if("/"==ch){if(stream.eat("*"))return state.tokenize=tokenComment,tokenComment(stream,state);if(stream.eat("/"))return stream.skipToEnd(),"comment"}if(isOperatorChar.test(ch))return stream.eatWhile(isOperatorChar),"operator";stream.eatWhile(/[\w\$_]/);var cur=stream.current();return keywords.propertyIsEnumerable(cur)?(blockKeywords.propertyIsEnumerable(cur)&&(curPunc="newstatement"),"keyword"):builtin.propertyIsEnumerable(cur)?(blockKeywords.propertyIsEnumerable(cur)&&(curPunc="newstatement"),"builtin"):atoms.propertyIsEnumerable(cur)?"atom":"variable"}function tokenString(quote){return function(stream,state){for(var escaped=!1,next,end=!1;null!=(next=stream.next());){if(next==quote&&!escaped){end=!0;break}escaped=!escaped&&"\\"==next}return(end||!escaped&&!multiLineStrings)&&(state.tokenize=null),"string"}}function tokenComment(stream,state){for(var maybeEnd=!1,ch;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=null;break}maybeEnd="*"==ch}return"comment"}function Context(indented,column,type,align,prev){this.indented=indented,this.column=column,this.type=type,this.align=align,this.prev=prev}function pushContext(state,col,type){return state.context=new Context(state.indented,col,type,null,state.context)}function popContext(state){var t=state.context.type;return(")"==t||"]"==t||"}"==t)&&(state.indented=state.context.indented),state.context=state.context.prev}var indentUnit=config.indentUnit,keywords=parserConfig.keywords||{},builtin=parserConfig.builtin||{},blockKeywords=parserConfig.blockKeywords||{},atoms=parserConfig.atoms||{},hooks=parserConfig.hooks||{},multiLineStrings=parserConfig.multiLineStrings,isOperatorChar=/[+\-*&%=<>!?|\/]/,curPunc;
return{startState:function(basecolumn){return{tokenize:null,context:new Context((basecolumn||0)-indentUnit,0,"top",!1),indented:0,startOfLine:!0}},token:function(stream,state){var ctx=state.context;if(stream.sol()&&(null==ctx.align&&(ctx.align=!1),state.indented=stream.indentation(),state.startOfLine=!0),stream.eatSpace())return null;curPunc=null;var style=(state.tokenize||tokenBase)(stream,state);if("comment"==style||"meta"==style)return style;if(null==ctx.align&&(ctx.align=!0),";"!=curPunc&&":"!=curPunc||"statement"!=ctx.type)if("{"==curPunc)pushContext(state,stream.column(),"}");else if("["==curPunc)pushContext(state,stream.column(),"]");else if("("==curPunc)pushContext(state,stream.column(),")");else if("}"==curPunc){for(;"statement"==ctx.type;)ctx=popContext(state);for("}"==ctx.type&&(ctx=popContext(state));"statement"==ctx.type;)ctx=popContext(state)}else curPunc==ctx.type?popContext(state):("}"==ctx.type||"top"==ctx.type||"statement"==ctx.type&&"newstatement"==curPunc)&&pushContext(state,stream.column(),"statement");else popContext(state);return state.startOfLine=!1,style},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase&&null!=state.tokenize)return 0;var ctx=state.context,firstChar=textAfter&&textAfter.charAt(0);"statement"==ctx.type&&"}"==firstChar&&(ctx=ctx.prev);var closing=firstChar==ctx.type;return"statement"==ctx.type?ctx.indented+("{"==firstChar?0:indentUnit):ctx.align?ctx.column+(closing?0:1):ctx.indented+(closing?0:indentUnit)},electricChars:"{}"}}),function(){function words(str){for(var obj={},words=str.split(" "),i=0;words.length>i;++i)obj[words[i]]=!0;return obj}function cppHook(stream,state){return state.startOfLine?(stream.skipToEnd(),"meta"):!1}function tokenAtString(stream,state){for(var next;null!=(next=stream.next());)if('"'==next&&!stream.eat('"')){state.tokenize=null;break}return"string"}function mimes(ms,mode){for(var i=0;ms.length>i;++i)CodeMirror.defineMIME(ms[i],mode)}var cKeywords="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";CodeMirror.defineMIME("text/x-java",{name:"clike",keywords:words("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:words("catch class do else finally for if switch try while"),atoms:words("true false null"),hooks:{"@":function(stream,state){return stream.eatWhile(/[\w\$_]/),"meta"}}})}(),CodeMirror.defineMode("scheme",function(config,mode){function makeKeywords(str){for(var obj={},words=str.split(" "),i=0;words.length>i;++i)obj[words[i]]=!0;return obj}function stateStack(indent,type,prev){this.indent=indent,this.type=type,this.prev=prev}function pushStack(state,indent,type){state.indentStack=new stateStack(indent,type,state.indentStack)}function popStack(state){state.indentStack=state.indentStack.prev}function isBinaryNumber(stream){return stream.match(binaryMatcher)}function isOctalNumber(stream){return stream.match(octalMatcher)}function isDecimalNumber(stream,backup){return backup===!0&&stream.backUp(1),stream.match(decimalMatcher)}function isHexNumber(stream){return stream.match(hexMatcher)}var BUILTIN="builtin",COMMENT="comment",STRING="string",ATOM="atom",NUMBER="number",BRACKET="bracket",KEYWORD="keyword",INDENT_WORD_SKIP=2,KEYWORDS_SKIP=1,keywords=makeKeywords("λ case-lambda call/cc class define-class exit-handler field import inherit init-field interface let*-values let-values let/ec mixin opt-lambda override protect provide public rename require require-for-syntax syntax syntax-case syntax-error unit/sig unless when with-syntax and begin call-with-current-continuation call-with-input-file call-with-output-file case cond define define-syntax delay do dynamic-wind else for-each if lambda let let* let-syntax letrec letrec-syntax map or syntax-rules abs acos angle append apply asin assoc assq assv atan boolean? caar cadr call-with-input-file call-with-output-file call-with-values car cdddar cddddr cdr ceiling char->integer char-alphabetic? char-ci<=? char-ci<? char-ci=? char-ci>=? char-ci>? char-downcase char-lower-case? char-numeric? char-ready? char-upcase char-upper-case? char-whitespace? char<=? char<? char=? char>=? char>? char? close-input-port close-output-port complex? cons cos current-input-port current-output-port denominator display eof-object? eq? equal? eqv? eval even? exact->inexact exact? exp expt #f floor force gcd imag-part inexact->exact inexact? input-port? integer->char integer? interaction-environment lcm length list list->string list->vector list-ref list-tail list? load log magnitude make-polar make-rectangular make-string make-vector max member memq memv min modulo negative? newline not null-environment null? number->string number? numerator odd? open-input-file open-output-file output-port? pair? peek-char port? positive? procedure? quasiquote quote quotient rational? rationalize read read-char real-part real? remainder reverse round scheme-report-environment set! set-car! set-cdr! sin sqrt string string->list string->number string->symbol string-append string-ci<=? string-ci<? string-ci=? string-ci>=? string-ci>? string-copy string-fill! string-length string-ref string-set! string<=? string<? string=? string>=? string>? string? substring symbol->string symbol? #t tan transcript-off transcript-on truncate values vector vector->list vector-fill! vector-length vector-ref vector-set! with-input-from-file with-output-to-file write write-char zero?"),indentKeys=makeKeywords("define let letrec let* lambda"),binaryMatcher=new RegExp(/^(?:[-+]i|[-+][01]+#*(?:\/[01]+#*)?i|[-+]?[01]+#*(?:\/[01]+#*)?@[-+]?[01]+#*(?:\/[01]+#*)?|[-+]?[01]+#*(?:\/[01]+#*)?[-+](?:[01]+#*(?:\/[01]+#*)?)?i|[-+]?[01]+#*(?:\/[01]+#*)?)(?=[()\s;"]|$)/i),octalMatcher=new RegExp(/^(?:[-+]i|[-+][0-7]+#*(?:\/[0-7]+#*)?i|[-+]?[0-7]+#*(?:\/[0-7]+#*)?@[-+]?[0-7]+#*(?:\/[0-7]+#*)?|[-+]?[0-7]+#*(?:\/[0-7]+#*)?[-+](?:[0-7]+#*(?:\/[0-7]+#*)?)?i|[-+]?[0-7]+#*(?:\/[0-7]+#*)?)(?=[()\s;"]|$)/i),hexMatcher=new RegExp(/^(?:[-+]i|[-+][\da-f]+#*(?:\/[\da-f]+#*)?i|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?@[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?[-+](?:[\da-f]+#*(?:\/[\da-f]+#*)?)?i|[-+]?[\da-f]+#*(?:\/[\da-f]+#*)?)(?=[()\s;"]|$)/i),decimalMatcher=new RegExp(/^(?:[-+]i|[-+](?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)i|[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)@[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)|[-+]?(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)[-+](?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*)?i|(?:(?:(?:\d+#+\.?#*|\d+\.\d*#*|\.\d+#*|\d+)(?:[esfdl][-+]?\d+)?)|\d+#*\/\d+#*))(?=[()\s;"]|$)/i);return{startState:function(){return{indentStack:null,indentation:0,mode:!1,sExprComment:!1}},token:function(stream,state){if(null==state.indentStack&&stream.sol()&&(state.indentation=stream.indentation()),stream.eatSpace())return null;var returnType=null;switch(state.mode){case"string":for(var next,escaped=!1;null!=(next=stream.next());){if('"'==next&&!escaped){state.mode=!1;break}escaped=!escaped&&"\\"==next}returnType=STRING;break;case"comment":for(var next,maybeEnd=!1;null!=(next=stream.next());){if("#"==next&&maybeEnd){state.mode=!1;break}maybeEnd="|"==next}returnType=COMMENT;break;case"s-expr-comment":if(state.mode=!1,"("!=stream.peek()&&"["!=stream.peek()){stream.eatWhile(/[^/s]/),returnType=COMMENT;break}state.sExprComment=0;default:var ch=stream.next();if('"'==ch)state.mode="string",returnType=STRING;else if("'"==ch)returnType=ATOM;else if("#"==ch)if(stream.eat("|"))state.mode="comment",returnType=COMMENT;else if(stream.eat(/[tf]/i))returnType=ATOM;else if(stream.eat(";"))state.mode="s-expr-comment",returnType=COMMENT;else{var numTest=null,hasExactness=!1,hasRadix=!0;stream.eat(/[ei]/i)?hasExactness=!0:stream.backUp(1),stream.match(/^#b/i)?numTest=isBinaryNumber:stream.match(/^#o/i)?numTest=isOctalNumber:stream.match(/^#x/i)?numTest=isHexNumber:stream.match(/^#d/i)?numTest=isDecimalNumber:stream.match(/^[-+0-9.]/,!1)?(hasRadix=!1,numTest=isDecimalNumber):hasExactness||stream.eat("#"),null!=numTest&&(hasRadix&&!hasExactness&&stream.match(/^#[ei]/i),numTest(stream)&&(returnType=NUMBER))}else if(/^[-+0-9.]/.test(ch)&&isDecimalNumber(stream,!0))returnType=NUMBER;else if(";"==ch)stream.skipToEnd(),returnType=COMMENT;else if("("==ch||"["==ch){for(var keyWord="",indentTemp=stream.column(),letter;null!=(letter=stream.eat(/[^\s\(\[\;\)\]]/));)keyWord+=letter;keyWord.length>0&&indentKeys.propertyIsEnumerable(keyWord)?pushStack(state,indentTemp+INDENT_WORD_SKIP,ch):(stream.eatSpace(),stream.eol()||";"==stream.peek()?pushStack(state,indentTemp+1,ch):pushStack(state,indentTemp+stream.current().length,ch)),stream.backUp(stream.current().length-1),"number"==typeof state.sExprComment&&state.sExprComment++,returnType=BRACKET}else")"==ch||"]"==ch?(returnType=BRACKET,null!=state.indentStack&&state.indentStack.type==(")"==ch?"(":"[")&&(popStack(state),"number"==typeof state.sExprComment&&0==--state.sExprComment&&(returnType=COMMENT,state.sExprComment=!1))):(stream.eatWhile(/[\w\$_\-!$%&*+\.\/:<=>?@\^~]/),returnType=keywords&&keywords.propertyIsEnumerable(stream.current())?BUILTIN:"variable")}return"number"==typeof state.sExprComment?COMMENT:returnType},indent:function(state,textAfter){return null==state.indentStack?state.indentation:state.indentStack.indent}}}),CodeMirror.defineMIME("text/x-scheme","scheme");var parseJs={};(function(exports){function is_letter(ch){return UNICODE.letter.test(ch)}function is_digit(ch){return ch=ch.charCodeAt(0),ch>=48&&57>=ch}function is_unicode_digit(ch){return UNICODE.digit.test(ch)}function is_alphanumeric_char(ch){return is_digit(ch)||is_letter(ch)}function is_unicode_combining_mark(ch){return UNICODE.combining_mark.test(ch)}function is_unicode_connector_punctuation(ch){return UNICODE.connector_punctuation.test(ch)}function is_identifier_start(ch){return"$"==ch||"_"==ch||is_letter(ch)}function is_identifier_char(ch){return is_identifier_start(ch)||is_unicode_combining_mark(ch)||is_unicode_digit(ch)||is_unicode_connector_punctuation(ch)||"‌"==ch||"‍"==ch}function parse_js_number(num){return RE_HEX_NUMBER.test(num)?parseInt(num.substr(2),16):RE_OCT_NUMBER.test(num)?parseInt(num.substr(1),8):RE_DEC_NUMBER.test(num)?parseFloat(num):void 0}function JS_Parse_Error(message,line,col,pos){this.message=message,this.line=line+1,this.col=col+1,this.pos=pos+1,this.stack=(new Error).stack}function js_error(message,line,col,pos){throw new JS_Parse_Error(message,line,col,pos)}function is_token(token,type,val){return token.type==type&&(null==val||token.value==val)}function tokenizer($TEXT){function peek(){return S.text.charAt(S.pos)}function next(signal_eof,in_string){var ch=S.text.charAt(S.pos++);if(signal_eof&&!ch)throw EX_EOF;return"\n"==ch?(S.newline_before=S.newline_before||!in_string,++S.line,S.col=0):++S.col,ch}function eof(){return!S.peek()}function find(what,signal_eof){var pos=S.text.indexOf(what,S.pos);if(signal_eof&&-1==pos)throw EX_EOF;return pos}function start_token(){S.tokline=S.line,S.tokcol=S.col,S.tokpos=S.pos}function token(type,value,is_comment){S.regex_allowed="operator"==type&&!HOP(UNARY_POSTFIX,value)||"keyword"==type&&HOP(KEYWORDS_BEFORE_EXPRESSION,value)||"punc"==type&&HOP(PUNC_BEFORE_EXPRESSION,value);var ret={type:type,value:value,line:S.tokline,col:S.tokcol,pos:S.tokpos,endpos:S.pos,nlb:S.newline_before};if(!is_comment){ret.comments_before=S.comments_before,S.comments_before=[];for(var i=0,len=ret.comments_before.length;len>i;i++)ret.nlb=ret.nlb||ret.comments_before[i].nlb}return S.newline_before=!1,ret}function skip_whitespace(){for(;HOP(WHITESPACE_CHARS,peek());)next()}function read_while(pred){for(var ret="",ch=peek(),i=0;ch&&pred(ch,i++);)ret+=next(),ch=peek();return ret}function parse_error(err){js_error(err,S.tokline,S.tokcol,S.tokpos)}function read_num(prefix){var has_e=!1,after_e=!1,has_x=!1,has_dot="."==prefix,num=read_while(function(ch,i){return"x"==ch||"X"==ch?has_x?!1:has_x=!0:has_x||"E"!=ch&&"e"!=ch?"-"==ch?after_e||0==i&&!prefix?!0:!1:"+"==ch?after_e:(after_e=!1,"."==ch?has_dot||has_x||has_e?!1:has_dot=!0:is_alphanumeric_char(ch)):has_e?!1:has_e=after_e=!0});prefix&&(num=prefix+num);var valid=parse_js_number(num);return isNaN(valid)?(parse_error("Invalid syntax: "+num),void 0):token("num",valid)}function read_escaped_char(in_string){var ch=next(!0,in_string);switch(ch){case"n":return"\n";case"r":return"\r";case"t":return"	";case"b":return"\b";case"v":return"";case"f":return"\f";case"0":return"\0";case"x":return String.fromCharCode(hex_bytes(2));case"u":return String.fromCharCode(hex_bytes(4));case"\n":return"";default:return ch}}function hex_bytes(n){for(var num=0;n>0;--n){var digit=parseInt(next(!0),16);isNaN(digit)&&parse_error("Invalid hex-character pattern in string"),num=num<<4|digit}return num}function read_string(){return with_eof_error("Unterminated string constant",function(){for(var quote=next(),ret="";;){var ch=next(!0);if("\\"==ch){var octal_len=0,first=null;ch=read_while(function(ch){if(ch>="0"&&"7">=ch){if(!first)return first=ch,++octal_len;if("3">=first&&2>=octal_len)return++octal_len;if(first>="4"&&1>=octal_len)return++octal_len}return!1}),ch=octal_len>0?String.fromCharCode(parseInt(ch,8)):read_escaped_char(!0)}else{if(ch==quote)break;if("\n"==ch)throw EX_EOF}ret+=ch}return token("string",ret)})}function read_line_comment(){next();var i=find("\n"),ret;return-1==i?(ret=S.text.substr(S.pos),S.pos=S.text.length):(ret=S.text.substring(S.pos,i),S.pos=i),token("comment1",ret,!0)}function read_multiline_comment(){return next(),with_eof_error("Unterminated multiline comment",function(){var i=find("*/",!0),text=S.text.substring(S.pos,i);return S.pos=i+2,S.line+=text.split("\n").length-1,S.newline_before=S.newline_before||text.indexOf("\n")>=0,/^@cc_on/i.test(text)&&(warn("WARNING: at line "+S.line),warn('*** Found "conditional comment": '+text),warn("*** UglifyJS DISCARDS ALL COMMENTS.  This means your code might no longer work properly in Internet Explorer.")),token("comment2",text,!0)})}function read_name(){for(var backslash=!1,name="",ch,escaped=!1,hex;null!=(ch=peek());)if(backslash)"u"!=ch&&parse_error("Expecting UnicodeEscapeSequence -- uXXXX"),ch=read_escaped_char(),is_identifier_char(ch)||parse_error("Unicode char: "+ch.charCodeAt(0)+" is not valid in identifier"),name+=ch,backslash=!1;else if("\\"==ch)escaped=backslash=!0,next();else{if(!is_identifier_char(ch))break;name+=next()}return HOP(KEYWORDS,name)&&escaped&&(hex=name.charCodeAt(0).toString(16).toUpperCase(),name="\\u"+"0000".substr(hex.length)+hex+name.slice(1)),name}function read_regexp(regexp){return with_eof_error("Unterminated regular expression",function(){for(var prev_backslash=!1,ch,in_class=!1;ch=next(!0);)if(prev_backslash)regexp+="\\"+ch,prev_backslash=!1;else if("["==ch)in_class=!0,regexp+=ch;else if("]"==ch&&in_class)in_class=!1,regexp+=ch;else{if("/"==ch&&!in_class)break;"\\"==ch?prev_backslash=!0:regexp+=ch}var mods=read_name();return token("regexp",[regexp,mods])})}function read_operator(prefix){function grow(op){if(!peek())return op;var bigger=op+peek();return HOP(OPERATORS,bigger)?(next(),grow(bigger)):op}return token("operator",grow(prefix||next()))}function handle_slash(){next();var regex_allowed=S.regex_allowed;switch(peek()){case"/":return S.comments_before.push(read_line_comment()),S.regex_allowed=regex_allowed,next_token();case"*":return S.comments_before.push(read_multiline_comment()),S.regex_allowed=regex_allowed,next_token()}return S.regex_allowed?read_regexp(""):read_operator("/")}function handle_dot(){return next(),is_digit(peek())?read_num("."):token("punc",".")}function read_word(){var word=read_name();return HOP(KEYWORDS,word)?HOP(OPERATORS,word)?token("operator",word):HOP(KEYWORDS_ATOM,word)?token("atom",word):token("keyword",word):token("name",word)}function with_eof_error(eof_error,cont){try{return cont()}catch(ex){if(ex!==EX_EOF)throw ex;parse_error(eof_error)}}function next_token(force_regexp){if(null!=force_regexp)return read_regexp(force_regexp);skip_whitespace(),start_token();var ch=peek();return ch?is_digit(ch)?read_num():'"'==ch||"'"==ch?read_string():HOP(PUNC_CHARS,ch)?token("punc",next()):"."==ch?handle_dot():"/"==ch?handle_slash():HOP(OPERATOR_CHARS,ch)?read_operator():"\\"==ch||is_identifier_start(ch)?read_word():(parse_error("Unexpected character '"+ch+"'"),void 0):token("eof")}var S={text:$TEXT.replace(/\r\n?|[\n\u2028\u2029]/g,"\n").replace(/^\uFEFF/,""),pos:0,tokpos:0,line:0,tokline:0,col:0,tokcol:0,newline_before:!1,regex_allowed:!1,comments_before:[]};return next_token.context=function(nc){return nc&&(S=nc),S},next_token}function NodeWithToken(str,start,end){this.name=str,this.start=start,this.end=end}function parse($TEXT,exigent_mode,embed_tokens){function is(type,value){return is_token(S.token,type,value)}function peek(){return S.peeked||(S.peeked=S.input())}function next(){return S.prev=S.token,S.peeked?(S.token=S.peeked,S.peeked=null):S.token=S.input(),S.in_directives=S.in_directives&&("string"==S.token.type||is("punc",";")),S.token}function prev(){return S.prev}function croak(msg,line,col,pos){var ctx=S.input.context();js_error(msg,null!=line?line:ctx.tokline,null!=col?col:ctx.tokcol,null!=pos?pos:ctx.tokpos)}function token_error(token,msg){croak(msg,token.line,token.col)}function unexpected(token){null==token&&(token=S.token),token_error(token,"Unexpected token: "+token.type+" ("+token.value+")")}function expect_token(type,val){return is(type,val)?next():(token_error(S.token,"Unexpected token "+S.token.type+", expected "+type),void 0)}function expect(punc){return expect_token("punc",punc)}function can_insert_semicolon(){return!exigent_mode&&(S.token.nlb||is("eof")||is("punc","}"))}function semicolon(){is("punc",";")?next():can_insert_semicolon()||unexpected()}function as(){return slice(arguments)}function parenthesised(){expect("(");var ex=expression();return expect(")"),ex}function add_tokens(str,start,end){return str instanceof NodeWithToken?str:new NodeWithToken(str,start,end)}function maybe_embed_tokens(parser){return embed_tokens?function(){var start=S.token,ast=parser.apply(this,arguments);return ast[0]=add_tokens(ast[0],start,prev()),ast}:parser}function labeled_statement(label){S.labels.push(label);var start=S.token,stat=statement();return exigent_mode&&!HOP(STATEMENTS_WITH_LABELS,stat[0])&&unexpected(start),S.labels.pop(),as("label",label,stat)}function simple_statement(){return as("stat",prog1(expression,semicolon))}function break_cont(type){var name;return can_insert_semicolon()||(name=is("name")?S.token.value:null),null!=name?(next(),member(name,S.labels)||croak("Label "+name+" without matching loop or statement")):0==S.in_loop&&croak(type+" not inside a loop or switch"),semicolon(),as(type,name)}function for_(){expect("(");var init=null;return!is("punc",";")&&(init=is("keyword","var")?(next(),var_(!0)):expression(!0,!0),is("operator","in"))?("var"==init[0]&&init[1].length>1&&croak("Only one variable declaration allowed in for..in loop"),for_in(init)):regular_for(init)}function regular_for(init){expect(";");var test=is("punc",";")?null:expression();expect(";");var step=is("punc",")")?null:expression();return expect(")"),as("for",init,test,step,in_loop(statement))}function for_in(init){var lhs="var"==init[0]?as("name",init[1][0]):init;next();var obj=expression();return expect(")"),as("for-in",init,lhs,obj,in_loop(statement))}function if_(){var cond=parenthesised(),body=statement(),belse;return is("keyword","else")&&(next(),belse=statement()),as("if",cond,body,belse)}function block_(){expect("{");for(var a=[];!is("punc","}");)is("eof")&&unexpected(),a.push(statement());return next(),a}function try_(){var body=block_(),bcatch,bfinally;if(is("keyword","catch")){next(),expect("("),is("name")||croak("Name expected");var name=S.token.value;next(),expect(")"),bcatch=[name,block_()]}return is("keyword","finally")&&(next(),bfinally=block_()),bcatch||bfinally||croak("Missing catch/finally blocks"),as("try",body,bcatch,bfinally)}function vardefs(no_in){for(var a=[];;){is("name")||unexpected();var name=S.token.value;if(next(),is("operator","=")?(next(),a.push([name,expression(!1,no_in)])):a.push([name]),!is("punc",","))break;next()}return a}function var_(no_in){return as("var",vardefs(no_in))}function const_(){return as("const",vardefs())}function new_(){var newexp=expr_atom(!1),args;return is("punc","(")?(next(),args=expr_list(")")):args=[],subscripts(as("new",newexp,args),!0)}function expr_list(closing,allow_trailing_comma,allow_empty){for(var first=!0,a=[];!is("punc",closing)&&(first?first=!1:expect(","),!allow_trailing_comma||!is("punc",closing));)is("punc",",")&&allow_empty?a.push(["atom","undefined"]):a.push(expression(!1));return next(),a}function array_(){return as("array",expr_list("]",!exigent_mode,!0))}function object_(){for(var first=!0,a=[];!is("punc","}")&&(first?first=!1:expect(","),exigent_mode||!is("punc","}"));){var type=S.token.type,name=as_property_name();"name"!=type||"get"!=name&&"set"!=name||is("punc",":")?(expect(":"),a.push([name,expression(!1)])):a.push([as_name(),function_(!1),name])}return next(),as("object",a)}function as_property_name(){switch(S.token.type){case"num":case"string":return prog1(S.token.value,next)}return as_name()}function as_name(){switch(S.token.type){case"name":case"operator":case"keyword":case"atom":return prog1(S.token.value,next);default:unexpected()}}function subscripts(expr,allow_calls){return is("punc",".")?(next(),subscripts(as("dot",expr,as_name()),allow_calls)):is("punc","[")?(next(),subscripts(as("sub",expr,prog1(expression,curry(expect,"]"))),allow_calls)):allow_calls&&is("punc","(")?(next(),subscripts(as("call",expr,expr_list(")")),!0)):expr}function maybe_unary(allow_calls){if(is("operator")&&HOP(UNARY_PREFIX,S.token.value))return make_unary("unary-prefix",prog1(S.token.value,next),maybe_unary(allow_calls));for(var val=expr_atom(allow_calls);is("operator")&&HOP(UNARY_POSTFIX,S.token.value)&&!S.token.nlb;)val=make_unary("unary-postfix",S.token.value,val),next();return val}function make_unary(tag,op,expr){return"++"!=op&&"--"!=op||is_assignable(expr)||croak("Invalid use of "+op+" operator"),as(tag,op,expr)}function expr_op(left,min_prec,no_in){var op=is("operator")?S.token.value:null;op&&"in"==op&&no_in&&(op=null);var prec=null!=op?PRECEDENCE[op]:null;if(null!=prec&&prec>min_prec){next();var right=expr_op(maybe_unary(!0),prec,no_in);return expr_op(as("binary",op,left,right),min_prec,no_in)}return left}function expr_ops(no_in){return expr_op(maybe_unary(!0),0,no_in)}function maybe_conditional(no_in){var expr=expr_ops(no_in);if(is("operator","?")){next();var yes=expression(!1);return expect(":"),as("conditional",expr,yes,expression(!1,no_in))}return expr}function is_assignable(expr){if(!exigent_mode)return!0;switch(expr[0]+""){case"dot":case"sub":case"new":case"call":return!0;case"name":return"this"!=expr[1]}}function maybe_assign(no_in){var left=maybe_conditional(no_in),val=S.token.value;if(is("operator")&&HOP(ASSIGNMENT,val)){if(is_assignable(left))return next(),as("assign",ASSIGNMENT[val],left,maybe_assign(no_in));croak("Invalid assignment")}return left}function in_loop(cont){try{return++S.in_loop,cont()}finally{--S.in_loop}}var S={input:"string"==typeof $TEXT?tokenizer($TEXT,!0):$TEXT,token:null,prev:null,peeked:null,in_function:0,in_directives:!0,in_loop:0,labels:[]};S.token=next();var statement=maybe_embed_tokens(function(){switch((is("operator","/")||is("operator","/="))&&(S.peeked=null,S.token=S.input(S.token.value.substr(1))),S.token.type){case"string":var dir=S.in_directives,stat=simple_statement();return dir&&"string"==stat[1][0]&&!is("punc",",")?as("directive",stat[1][1]):stat;case"num":case"regexp":case"operator":case"atom":return simple_statement();case"name":return is_token(peek(),"punc",":")?labeled_statement(prog1(S.token.value,next,next)):simple_statement();case"punc":switch(S.token.value){case"{":return as("block",block_());case"[":case"(":return simple_statement();case";":return next(),as("block");default:unexpected()}case"keyword":switch(prog1(S.token.value,next)){case"break":return break_cont("break");case"continue":return break_cont("continue");case"debugger":return semicolon(),as("debugger");case"do":return function(body){return expect_token("keyword","while"),as("do",prog1(parenthesised,semicolon),body)}(in_loop(statement));case"for":return for_();case"function":return function_(!0);case"if":return if_();case"return":return 0==S.in_function&&croak("'return' outside of function"),as("return",is("punc",";")?(next(),null):can_insert_semicolon()?null:prog1(expression,semicolon));case"switch":return as("switch",parenthesised(),switch_block_());case"throw":return S.token.nlb&&croak("Illegal newline after 'throw'"),as("throw",prog1(expression,semicolon));case"try":return try_();case"var":return prog1(var_,semicolon);case"const":return prog1(const_,semicolon);case"while":return as("while",parenthesised(),in_loop(statement));case"with":return as("with",parenthesised(),statement());default:unexpected()}}}),function_=function(in_statement){var name=is("name")?prog1(S.token.value,next):null;return in_statement&&!name&&unexpected(),expect("("),as(in_statement?"defun":"function",name,function(first,a){for(;!is("punc",")");)first?first=!1:expect(","),is("name")||unexpected(),a.push(S.token.value),next();return next(),a}(!0,[]),function(){++S.in_function;var loop=S.in_loop;S.in_directives=!0,S.in_loop=0;var a=block_();return--S.in_function,S.in_loop=loop,a}())},switch_block_=curry(in_loop,function(){expect("{");for(var a=[],cur=null;!is("punc","}");)is("eof")&&unexpected(),is("keyword","case")?(next(),cur=[],a.push([expression(),cur]),expect(":")):is("keyword","default")?(next(),expect(":"),cur=[],a.push([null,cur])):(cur||unexpected(),cur.push(statement()));return next(),a}),expr_atom=maybe_embed_tokens(function(allow_calls){if(is("operator","new"))return next(),new_();if(is("punc")){switch(S.token.value){case"(":return next(),subscripts(prog1(expression,curry(expect,")")),allow_calls);case"[":return next(),subscripts(array_(),allow_calls);case"{":return next(),subscripts(object_(),allow_calls)}unexpected()}if(is("keyword","function"))return next(),subscripts(function_(!1),allow_calls);if(HOP(ATOMIC_START_TOKEN,S.token.type)){var atom="regexp"==S.token.type?as("regexp",S.token.value[0],S.token.value[1]):as(S.token.type,S.token.value);return subscripts(prog1(atom,next),allow_calls)}unexpected()}),expression=maybe_embed_tokens(function(commas,no_in){0==arguments.length&&(commas=!0);var expr=maybe_assign(no_in);return commas&&is("punc",",")?(next(),as("seq",expr,expression(!0,no_in))):expr});return as("toplevel",function(a){for(;!is("eof");)a.push(statement());return a}([]))}function curry(f){var args=slice(arguments,1);return function(){return f.apply(this,args.concat(slice(arguments)))}}function prog1(ret){ret instanceof Function&&(ret=ret());for(var i=1,n=arguments.length;--n>0;++i)arguments[i]();return ret}function array_to_hash(a){for(var ret={},i=0;a.length>i;++i)ret[a[i]]=!0;return ret}function slice(a,start){return Array.prototype.slice.call(a,start||0)}function characters(str){return str.split("")}function member(name,array){for(var i=array.length;--i>=0;)if(array[i]==name)return!0;return!1}function HOP(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var KEYWORDS=array_to_hash(["break","case","catch","const","continue","debugger","default","delete","do","else","finally","for","function","if","in","instanceof","new","return","switch","throw","try","typeof","var","void","while","with"]),RESERVED_WORDS=array_to_hash(["abstract","boolean","byte","char","class","double","enum","export","extends","final","float","goto","implements","import","int","interface","long","native","package","private","protected","public","short","static","super","synchronized","throws","transient","volatile"]),KEYWORDS_BEFORE_EXPRESSION=array_to_hash(["return","new","delete","throw","else","case"]),KEYWORDS_ATOM=array_to_hash(["false","null","true","undefined"]),OPERATOR_CHARS=array_to_hash(characters("+-*&%=<>!?|~^")),RE_HEX_NUMBER=/^0x[0-9a-f]+$/i,RE_OCT_NUMBER=/^0[0-7]+$/,RE_DEC_NUMBER=/^\d*\.?\d*(?:e[+-]?\d*(?:\d\.?|\.?\d)\d*)?$/i,OPERATORS=array_to_hash(["in","instanceof","typeof","new","void","delete","++","--","+","-","!","~","&","|","^","*","/","%",">>","<<",">>>","<",">","<=",">=","==","===","!=","!==","?","=","+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&=","&&","||"]),WHITESPACE_CHARS=array_to_hash(characters("  \n\r	\f​᠎             　﻿")),PUNC_BEFORE_EXPRESSION=array_to_hash(characters("[{(,.;:")),PUNC_CHARS=array_to_hash(characters("[]{}(),;:")),REGEXP_MODIFIERS=array_to_hash(characters("gmsiy")),UNICODE={letter:new RegExp("[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F0\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),combining_mark:new RegExp("[\\u0300-\\u036F\\u0483-\\u0487\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0859-\\u085B\\u08E4-\\u08FE\\u0900-\\u0903\\u093A-\\u093C\\u093E-\\u094F\\u0951-\\u0957\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A01-\\u0A03\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AE2\\u0AE3\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B62\\u0B63\\u0B82\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C01-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0C82\\u0C83\\u0CBC\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CE2\\u0CE3\\u0D02\\u0D03\\u0D3E-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0D62\\u0D63\\u0D82\\u0D83\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86\\u0F87\\u0F8D-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102B-\\u103E\\u1056-\\u1059\\u105E-\\u1060\\u1062-\\u1064\\u1067-\\u106D\\u1071-\\u1074\\u1082-\\u108D\\u108F\\u109A-\\u109D\\u135D-\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B4-\\u17D3\\u17DD\\u180B-\\u180D\\u18A9\\u1920-\\u192B\\u1930-\\u193B\\u19B0-\\u19C0\\u19C8\\u19C9\\u1A17-\\u1A1B\\u1A55-\\u1A5E\\u1A60-\\u1A7C\\u1A7F\\u1B00-\\u1B04\\u1B34-\\u1B44\\u1B6B-\\u1B73\\u1B80-\\u1B82\\u1BA1-\\u1BAD\\u1BE6-\\u1BF3\\u1C24-\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE8\\u1CED\\u1CF2-\\u1CF4\\u1DC0-\\u1DE6\\u1DFC-\\u1DFF\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2CEF-\\u2CF1\\u2D7F\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F\\uA674-\\uA67D\\uA69F\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA823-\\uA827\\uA880\\uA881\\uA8B4-\\uA8C4\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA953\\uA980-\\uA983\\uA9B3-\\uA9C0\\uAA29-\\uAA36\\uAA43\\uAA4C\\uAA4D\\uAA7B\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uAAEB-\\uAAEF\\uAAF5\\uAAF6\\uABE3-\\uABEA\\uABEC\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE26]"),connector_punctuation:new RegExp("[\\u005F\\u203F\\u2040\\u2054\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFF3F]"),digit:new RegExp("[\\u0030-\\u0039\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE6-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\u1040-\\u1049\\u1090-\\u1099\\u17E0-\\u17E9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19D9\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\uA620-\\uA629\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]")};
JS_Parse_Error.prototype.toString=function(){return this.message+" (line: "+this.line+", col: "+this.col+", pos: "+this.pos+")"+"\n\n"+this.stack};var EX_EOF={},UNARY_PREFIX=array_to_hash(["typeof","void","delete","--","++","!","~","-","+"]),UNARY_POSTFIX=array_to_hash(["--","++"]),ASSIGNMENT=function(a,ret,i){for(;a.length>i;)ret[a[i]]=a[i].substr(0,a[i].length-1),i++;return ret}(["+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&="],{"=":!0},0),PRECEDENCE=function(a,ret){for(var i=0,n=1;a.length>i;++i,++n)for(var b=a[i],j=0;b.length>j;++j)ret[b[j]]=n;return ret}([["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"]],{}),STATEMENTS_WITH_LABELS=array_to_hash(["for","do","while","switch"]),ATOMIC_START_TOKEN=array_to_hash(["atom","num","string","regexp","name"]);NodeWithToken.prototype.toString=function(){return this.name};var warn=function(){};exports.tokenizer=tokenizer,exports.parse=parse,exports.slice=slice,exports.curry=curry,exports.member=member,exports.array_to_hash=array_to_hash,exports.PRECEDENCE=PRECEDENCE,exports.KEYWORDS_ATOM=KEYWORDS_ATOM,exports.RESERVED_WORDS=RESERVED_WORDS,exports.KEYWORDS=KEYWORDS,exports.ATOMIC_START_TOKEN=ATOMIC_START_TOKEN,exports.OPERATORS=OPERATORS,exports.is_alphanumeric_char=is_alphanumeric_char,exports.is_identifier_start=is_identifier_start,exports.is_identifier_char=is_identifier_char,exports.set_logger=function(logger){warn=logger}})(parseJs);var process={};(function(exports,jsp){function ast_walker(){function _vardefs(defs){return[this[0],MAP(defs,function(def){var a=[def[0]];return def.length>1&&(a[1]=walk(def[1])),a})]}function _block(statements){var out=[this[0]];return null!=statements&&out.push(MAP(statements,walk)),out}function walk(ast){if(null==ast)return null;try{stack.push(ast);var type=ast[0],gen=user[type];if(gen){var ret=gen.apply(ast,ast.slice(1));if(null!=ret)return ret}return gen=walkers[type],gen.apply(ast,ast.slice(1))}finally{stack.pop()}}function dive(ast){if(null==ast)return null;try{return stack.push(ast),walkers[ast[0]].apply(ast,ast.slice(1))}finally{stack.pop()}}function with_walkers(walkers,cont){var save={},i;for(i in walkers)HOP(walkers,i)&&(save[i]=user[i],user[i]=walkers[i]);var ret=cont();for(i in save)HOP(save,i)&&(save[i]?user[i]=save[i]:delete user[i]);return ret}var walkers={string:function(str){return[this[0],str]},num:function(num){return[this[0],num]},name:function(name){return[this[0],name]},toplevel:function(statements){return[this[0],MAP(statements,walk)]},block:_block,splice:_block,"var":_vardefs,"const":_vardefs,"try":function(t,c,f){return[this[0],MAP(t,walk),null!=c?[c[0],MAP(c[1],walk)]:null,null!=f?MAP(f,walk):null]},"throw":function(expr){return[this[0],walk(expr)]},"new":function(ctor,args){return[this[0],walk(ctor),MAP(args,walk)]},"switch":function(expr,body){return[this[0],walk(expr),MAP(body,function(branch){return[branch[0]?walk(branch[0]):null,MAP(branch[1],walk)]})]},"break":function(label){return[this[0],label]},"continue":function(label){return[this[0],label]},conditional:function(cond,t,e){return[this[0],walk(cond),walk(t),walk(e)]},assign:function(op,lvalue,rvalue){return[this[0],op,walk(lvalue),walk(rvalue)]},dot:function(expr){return[this[0],walk(expr)].concat(slice(arguments,1))},call:function(expr,args){return[this[0],walk(expr),MAP(args,walk)]},"function":function(name,args,body){return[this[0],name,args.slice(),MAP(body,walk)]},"debugger":function(){return[this[0]]},defun:function(name,args,body){return[this[0],name,args.slice(),MAP(body,walk)]},"if":function(conditional,t,e){return[this[0],walk(conditional),walk(t),walk(e)]},"for":function(init,cond,step,block){return[this[0],walk(init),walk(cond),walk(step),walk(block)]},"for-in":function(vvar,key,hash,block){return[this[0],walk(vvar),walk(key),walk(hash),walk(block)]},"while":function(cond,block){return[this[0],walk(cond),walk(block)]},"do":function(cond,block){return[this[0],walk(cond),walk(block)]},"return":function(expr){return[this[0],walk(expr)]},binary:function(op,left,right){return[this[0],op,walk(left),walk(right)]},"unary-prefix":function(op,expr){return[this[0],op,walk(expr)]},"unary-postfix":function(op,expr){return[this[0],op,walk(expr)]},sub:function(expr,subscript){return[this[0],walk(expr),walk(subscript)]},object:function(props){return[this[0],MAP(props,function(p){return 2==p.length?[p[0],walk(p[1])]:[p[0],walk(p[1]),p[2]]})]},regexp:function(rx,mods){return[this[0],rx,mods]},array:function(elements){return[this[0],MAP(elements,walk)]},stat:function(stat){return[this[0],walk(stat)]},seq:function(){return[this[0]].concat(MAP(slice(arguments),walk))},label:function(name,block){return[this[0],name,walk(block)]},"with":function(expr,block){return[this[0],walk(expr),walk(block)]},atom:function(name){return[this[0],name]},directive:function(dir){return[this[0],dir]}},user={},stack=[];return{walk:walk,dive:dive,with_walkers:with_walkers,parent:function(){return stack[stack.length-2]},stack:function(){return stack}}}function Scope(parent){this.names={},this.mangled={},this.rev_mangled={},this.cname=-1,this.refs={},this.uses_with=!1,this.uses_eval=!1,this.directives=[],this.parent=parent,this.children=[],parent?(this.level=parent.level+1,parent.children.push(this)):this.level=0}function base54_digits(){return"undefined"!=typeof DIGITS_OVERRIDE_FOR_TESTING?DIGITS_OVERRIDE_FOR_TESTING:"etnrisouaflchpdvmgybwESxTNCkLAOM_DPHBjFIqRUzWXV$JKQGYZ0516372984"}function ast_add_scope(ast){function with_new_scope(cont){current_scope=new Scope(current_scope),current_scope.labels=new Scope;var ret=current_scope.body=cont();return ret.scope=current_scope,current_scope=current_scope.parent,ret}function define(name,type){return current_scope.define(name,type)}function reference(name){current_scope.refs[name]=!0}function _lambda(name,args,body){var is_defun="defun"==this[0];return[this[0],is_defun?define(name,"defun"):name,args,with_new_scope(function(){return is_defun||define(name,"lambda"),MAP(args,function(name){define(name,"arg")}),MAP(body,walk)})]}function _vardefs(type){return function(defs){MAP(defs,function(d){define(d[0],type),d[1]&&reference(d[0])})}}function _breacont(label){label&&(current_scope.labels.refs[label]=!0)}var current_scope=null,w=ast_walker(),walk=w.walk,having_eval=[];return with_new_scope(function(){function fixrefs(scope,i){for(i=scope.children.length;--i>=0;)fixrefs(scope.children[i]);for(i in scope.refs)if(HOP(scope.refs,i))for(var origin=scope.has(i),s=scope;s&&(s.refs[i]=origin,s!==origin);s=s.parent);}var ret=w.with_walkers({"function":_lambda,defun:_lambda,label:function(name,stat){current_scope.labels.define(name)},"break":_breacont,"continue":_breacont,"with":function(expr,block){for(var s=current_scope;s;s=s.parent)s.uses_with=!0},"var":_vardefs("var"),"const":_vardefs("const"),"try":function(t,c,f){return null!=c?[this[0],MAP(t,walk),[define(c[0],"catch"),MAP(c[1],walk)],null!=f?MAP(f,walk):null]:void 0},name:function(name){"eval"==name&&having_eval.push(current_scope),reference(name)}},function(){return walk(ast)});return MAP(having_eval,function(scope){if(!scope.has("eval"))for(;scope;)scope.uses_eval=!0,scope=scope.parent}),fixrefs(current_scope),ret})}function ast_mangle(ast,options){function get_mangled(name,newMangle){return options.mangle?options.toplevel||scope.parent?options.except&&member(name,options.except)?name:options.no_functions&&HOP(scope.names,name)&&("defun"==scope.names[name]||"lambda"==scope.names[name])?name:scope.get_mangled(name,newMangle):name:name}function get_define(name){return options.defines?!scope.has(name)&&HOP(options.defines,name)?options.defines[name]:null:void 0}function _lambda(name,args,body){if(!options.no_functions&&options.mangle){var is_defun="defun"==this[0],extra;name&&(is_defun?name=get_mangled(name):body.scope.references(name)?(extra={},scope.uses_eval||scope.uses_with?extra[name]=name:name=extra[name]=scope.next_mangled()):name=null)}return body=with_scope(body.scope,function(){return args=MAP(args,function(name){return get_mangled(name)}),MAP(body,walk)},extra),[this[0],name,args,body]}function with_scope(s,cont,extra){var _scope=scope;if(scope=s,extra)for(var i in extra)HOP(extra,i)&&s.set_mangle(i,extra[i]);for(var i in s.names)HOP(s.names,i)&&get_mangled(i,!0);var ret=cont();return ret.scope=s,scope=_scope,ret}function _vardefs(defs){return[this[0],MAP(defs,function(d){return[get_mangled(d[0]),walk(d[1])]})]}function _breacont(label){return label?[this[0],scope.labels.get_mangled(label)]:void 0}var w=ast_walker(),walk=w.walk,scope;return options=defaults(options,{mangle:!0,toplevel:!1,defines:null,except:null,no_functions:!1}),w.with_walkers({"function":_lambda,defun:function(){var ast=_lambda.apply(this,arguments);switch(w.parent()[0]){case"toplevel":case"function":case"defun":return MAP.at_top(ast)}return ast},label:function(label,stat){return scope.labels.refs[label]?[this[0],scope.labels.get_mangled(label,!0),walk(stat)]:walk(stat)},"break":_breacont,"continue":_breacont,"var":_vardefs,"const":_vardefs,name:function(name){return get_define(name)||[this[0],get_mangled(name)]},"try":function(t,c,f){return[this[0],MAP(t,walk),null!=c?[get_mangled(c[0]),MAP(c[1],walk)]:null,null!=f?MAP(f,walk):null]},toplevel:function(body){var self=this;return with_scope(self.scope,function(){return[self[0],MAP(body,walk)]})},directive:function(){return MAP.at_top(this)}},function(){return walk(ast_add_scope(ast))})}function best_of(ast1,ast2){return gen_code(ast1).length>gen_code("stat"==ast2[0]?ast2[1]:ast2).length?ast2:ast1}function last_stat(b){return"block"==b[0]&&b[1]&&b[1].length>0?b[1][b[1].length-1]:b}function aborts(t){if(t)switch(last_stat(t)[0]){case"return":case"break":case"continue":case"throw":return!0}}function boolean_expr(expr){return"unary-prefix"==expr[0]&&member(expr[1],["!","delete"])||"binary"==expr[0]&&member(expr[1],["in","instanceof","==","!=","===","!==","<","<=",">=",">"])||"binary"==expr[0]&&member(expr[1],["&&","||"])&&boolean_expr(expr[2])&&boolean_expr(expr[3])||"conditional"==expr[0]&&boolean_expr(expr[2])&&boolean_expr(expr[3])||"assign"==expr[0]&&expr[1]===!0&&boolean_expr(expr[3])||"seq"==expr[0]&&boolean_expr(expr[expr.length-1])}function empty(b){return!b||"block"==b[0]&&(!b[1]||0==b[1].length)}function is_string(node){return"string"==node[0]||"unary-prefix"==node[0]&&"typeof"==node[1]||"binary"==node[0]&&"+"==node[1]&&(is_string(node[2])||is_string(node[3]))}function warn_unreachable(ast){empty(ast)||warn("Dropping unreachable code: "+gen_code(ast,!0))}function prepare_ifs(ast){function redo_if(statements){statements=MAP(statements,walk);for(var i=0;statements.length>i;++i){var fi=statements[i];if("if"==fi[0]&&!fi[3]){var t=fi[2];if(aborts(t)){var conditional=walk(fi[1]),e_body=redo_if(statements.slice(i+1)),e=1==e_body.length?e_body[0]:["block",e_body];return statements.slice(0,i).concat([[fi[0],conditional,t,e]])}}}return statements}function redo_if_lambda(name,args,body){return body=redo_if(body),[this[0],name,args,body]}function redo_if_block(statements){return[this[0],null!=statements?redo_if(statements):null]}var w=ast_walker(),walk=w.walk;return w.with_walkers({defun:redo_if_lambda,"function":redo_if_lambda,block:redo_if_block,splice:redo_if_block,toplevel:function(statements){return[this[0],redo_if(statements)]},"try":function(t,c,f){return[this[0],redo_if(t),null!=c?[c[0],redo_if(c[1])]:null,null!=f?redo_if(f):null]}},function(){return walk(ast)})}function for_side_effects(ast,handler){function stop(){throw $stop}function restart(){throw $restart}function found(){return handler.call(this,this,w,stop,restart)}function unary(op){return"++"==op||"--"==op?found.apply(this,arguments):void 0}function binary(op){return"&&"==op||"||"==op?found.apply(this,arguments):void 0}var w=ast_walker(),walk=w.walk,$stop={},$restart={};return w.with_walkers({"try":found,"throw":found,"return":found,"new":found,"switch":found,"break":found,"continue":found,assign:found,call:found,"if":found,"for":found,"for-in":found,"while":found,"do":found,"return":found,"unary-prefix":unary,"unary-postfix":unary,conditional:found,binary:binary,defun:found},function(){for(;;)try{walk(ast);break}catch(ex){if(ex===$stop)break;if(ex===$restart)continue;throw ex}})}function ast_lift_variables(ast){function do_body(body,env){var _scope=scope;scope=env,body=MAP(body,walk);var hash={},names=MAP(env.names,function(type,name){return"var"!=type?MAP.skip:env.references(name)?(hash[name]=!0,[name]):MAP.skip});return names.length>0&&(for_side_effects(["block",body],function(ast,walker,stop,restart){if("assign"==ast[0]&&ast[1]===!0&&"name"==ast[2][0]&&HOP(hash,ast[2][1])){for(var i=names.length;--i>=0;)if(names[i][0]==ast[2][1]){names[i][1]&&stop(),names[i][1]=ast[3],names.push(names.splice(i,1)[0]);break}var p=walker.parent();if("seq"==p[0]){var a=p[2];a.unshift(0,p.length),p.splice.apply(p,a)}else"stat"==p[0]?p.splice(0,p.length,"block"):stop();restart()}stop()}),body.unshift(["var",names])),scope=_scope,body}function _vardefs(defs){for(var ret=null,i=defs.length;--i>=0;){var d=defs[i];d[1]&&(d=["assign",!0,["name",d[0]],d[1]],ret=null==ret?d:["seq",d,ret])}return null==ret&&"for"!=w.parent()[0]?"for-in"==w.parent()[0]?["name",defs[0][0]]:MAP.skip:["stat",ret]}function _toplevel(body){return[this[0],do_body(body,this.scope)]}var w=ast_walker(),walk=w.walk,scope;return w.with_walkers({"function":function(name,args,body){for(var i=args.length;--i>=0&&!body.scope.references(args[i]);)args.pop();return body.scope.references(name)||(name=null),[this[0],name,args,do_body(body,body.scope)]},defun:function(name,args,body){if(!scope.references(name))return MAP.skip;for(var i=args.length;--i>=0&&!body.scope.references(args[i]);)args.pop();return[this[0],name,args,do_body(body,body.scope)]},"var":_vardefs,toplevel:_toplevel},function(){return walk(ast_add_scope(ast))})}function ast_squeeze(ast,options){return ast=squeeze_1(ast,options),ast=squeeze_2(ast,options)}function squeeze_1(ast,options){function negate(c){var not_c=["unary-prefix","!",c];switch(c[0]){case"unary-prefix":return"!"==c[1]&&boolean_expr(c[2])?c[2]:not_c;case"seq":return c=slice(c),c[c.length-1]=negate(c[c.length-1]),c;case"conditional":return best_of(not_c,["conditional",c[1],negate(c[2]),negate(c[3])]);case"binary":var op=c[1],left=c[2],right=c[3];if(!options.keep_comps)switch(op){case"<=":return["binary",">",left,right];case"<":return["binary",">=",left,right];case">=":return["binary","<",left,right];case">":return["binary","<=",left,right]}switch(op){case"==":return["binary","!=",left,right];case"!=":return["binary","==",left,right];case"===":return["binary","!==",left,right];case"!==":return["binary","===",left,right];case"&&":return best_of(not_c,["binary","||",negate(left),negate(right)]);case"||":return best_of(not_c,["binary","&&",negate(left),negate(right)])}}return not_c}function make_conditional(c,t,e){var make_real_conditional=function(){return"unary-prefix"==c[0]&&"!"==c[1]?e?["conditional",c[2],e,t]:["binary","||",c[2],t]:e?best_of(["conditional",c,t,e],["conditional",negate(c),e,t]):["binary","&&",c,t]};return when_constant(c,function(ast,val){return warn_unreachable(val?e:t),val?t:e},make_real_conditional)}function rmblock(block){return null!=block&&"block"==block[0]&&block[1]&&(1==block[1].length?block=block[1][0]:0==block[1].length&&(block=["block"])),block}function _lambda(name,args,body){return[this[0],name,args,tighten(body,"lambda")]}function tighten(statements,block_type){return statements=MAP(statements,walk),statements=statements.reduce(function(a,stat){return"block"==stat[0]?stat[1]&&a.push.apply(a,stat[1]):a.push(stat),a},[]),statements=function(a,prev){return statements.forEach(function(cur){prev&&("var"==cur[0]&&"var"==prev[0]||"const"==cur[0]&&"const"==prev[0])?prev[1]=prev[1].concat(cur[1]):(a.push(cur),prev=cur)}),a}([]),options.dead_code&&(statements=function(a,has_quit){return statements.forEach(function(st){has_quit?"function"==st[0]||"defun"==st[0]?a.push(st):"var"==st[0]||"const"==st[0]?(options.no_warnings||warn("Variables declared in unreachable code"),st[1]=MAP(st[1],function(def){return def[1]&&!options.no_warnings&&warn_unreachable(["assign",!0,["name",def[0]],def[1]]),[def[0]]}),a.push(st)):options.no_warnings||warn_unreachable(st):(a.push(st),member(st[0],["return","throw","break","continue"])&&(has_quit=!0))}),a}([])),options.make_seqs&&(statements=function(a,prev){return statements.forEach(function(cur){prev&&"stat"==prev[0]&&"stat"==cur[0]?prev[1]=["seq",prev[1],cur[1]]:(a.push(cur),prev=cur)}),a.length>=2&&"stat"==a[a.length-2][0]&&("return"==a[a.length-1][0]||"throw"==a[a.length-1][0])&&a[a.length-1][1]&&a.splice(a.length-2,2,[a[a.length-1][0],["seq",a[a.length-2][1],a[a.length-1][1]]]),a}([])),statements}function make_if(c,t,e){return when_constant(c,function(ast,val){return val?(t=walk(t),warn_unreachable(e),t||["block"]):(e=walk(e),warn_unreachable(t),e||["block"])},function(){return make_real_if(c,t,e)})}function abort_else(c,t,e){var ret=[["if",negate(c),e]];return"block"==t[0]?t[1]&&(ret=ret.concat(t[1])):ret.push(t),walk(["block",ret])}function make_real_if(c,t,e){if(c=walk(c),t=walk(t),e=walk(e),empty(e)&&empty(t))return["stat",c];empty(t)?(c=negate(c),t=e,e=null):empty(e)?e=null:function(){var a=gen_code(c),n=negate(c),b=gen_code(n);if(a.length>b.length){var tmp=t;t=e,e=tmp,c=n}}();var ret=["if",c,t,e];return"if"==t[0]&&empty(t[3])&&empty(e)?ret=best_of(ret,walk(["if",["binary","&&",c,t[1]],t[2]])):"stat"==t[0]?e?"stat"==e[0]?ret=best_of(ret,["stat",make_conditional(c,t[1],e[1])]):aborts(e)&&(ret=abort_else(c,t,e)):ret=best_of(ret,["stat",make_conditional(c,t[1])]):e&&t[0]==e[0]&&("return"==t[0]||"throw"==t[0])&&t[1]&&e[1]?ret=best_of(ret,[t[0],make_conditional(c,t[1],e[1])]):e&&aborts(t)?(ret=[["if",c,t]],"block"==e[0]?e[1]&&(ret=ret.concat(e[1])):ret.push(e),ret=walk(["block",ret])):t&&aborts(e)&&(ret=abort_else(c,t,e)),ret}function _do_while(cond,body){return when_constant(cond,function(cond,val){return val?["for",null,null,null,walk(body)]:(warn_unreachable(body),["block"])})}options=defaults(options,{make_seqs:!0,dead_code:!0,no_warnings:!1,keep_comps:!0,unsafe:!1});var w=ast_walker(),walk=w.walk,scope;return w.with_walkers({sub:function(expr,subscript){if("string"==subscript[0]){var name=subscript[1];if(is_identifier(name))return["dot",walk(expr),name];if(/^[1-9][0-9]*$/.test(name)||"0"===name)return["sub",walk(expr),["num",parseInt(name,10)]]}},"if":make_if,toplevel:function(body){return["toplevel",tighten(body)]},"switch":function(expr,body){var last=body.length-1;return["switch",walk(expr),MAP(body,function(branch,i){var block=tighten(branch[1]);if(i==last&&block.length>0){var node=block[block.length-1];"break"!=node[0]||node[1]||block.pop()}return[branch[0]?walk(branch[0]):null,block]})]},"function":_lambda,defun:_lambda,block:function(body){return body?rmblock(["block",tighten(body)]):void 0},binary:function(op,left,right){return when_constant(["binary",op,walk(left),walk(right)],function yes(c){return best_of(walk(c),this)},function no(){return function(){if("=="==op||"!="==op){var l=walk(left),r=walk(right);return l&&"unary-prefix"==l[0]&&"!"==l[1]&&"num"==l[2][0]?left=["num",+!l[2][1]]:r&&"unary-prefix"==r[0]&&"!"==r[1]&&"num"==r[2][0]&&(right=["num",+!r[2][1]]),["binary",op,left,right]}}()||this})},conditional:function(c,t,e){return make_conditional(walk(c),walk(t),walk(e))},"try":function(t,c,f){return["try",tighten(t),null!=c?[c[0],tighten(c[1])]:null,null!=f?tighten(f):null]},"unary-prefix":function(op,expr){expr=walk(expr);var ret=["unary-prefix",op,expr];return"!"==op&&(ret=best_of(ret,negate(expr))),when_constant(ret,function(ast,val){return walk(ast)},function(){return ret})},name:function(name){switch(name){case"true":return["unary-prefix","!",["num",0]];case"false":return["unary-prefix","!",["num",1]]}},"while":_do_while,assign:function(op,lvalue,rvalue){lvalue=walk(lvalue),rvalue=walk(rvalue);var okOps=["+","-","/","*","%",">>","<<",">>>","|","^","&"];return op===!0&&"name"===lvalue[0]&&"binary"===rvalue[0]&&~okOps.indexOf(rvalue[1])&&"name"===rvalue[2][0]&&rvalue[2][1]===lvalue[1]?[this[0],rvalue[1],lvalue,rvalue[3]]:[this[0],op,lvalue,rvalue]},call:function(expr,args){return expr=walk(expr),options.unsafe&&"dot"==expr[0]&&"string"==expr[1][0]&&"toString"==expr[2]?expr[1]:[this[0],expr,MAP(args,walk)]},num:function(num){return isFinite(num)?[this[0],num]:["binary","/",num===1/0?["num",1]:num===-1/0?["unary-prefix","-",["num",1]]:["num",0],["num",0]]}},function(){return walk(prepare_ifs(walk(prepare_ifs(ast))))})}function squeeze_2(ast,options){function with_scope(s,cont){var save=scope,ret;return scope=s,ret=cont(),scope=save,ret}function lambda(name,args,body){return[this[0],name,args,with_scope(body.scope,curry(MAP,body,walk))]}var w=ast_walker(),walk=w.walk,scope;return w.with_walkers({directive:function(dir){return scope.active_directive(dir)?["block"]:(scope.directives.push(dir),void 0)},toplevel:function(body){return[this[0],with_scope(this.scope,curry(MAP,body,walk))]},"function":lambda,defun:lambda},function(){return walk(ast_add_scope(ast))})}function make_string(str,ascii_only){var dq=0,sq=0;return str=str.replace(/[\\\b\f\n\r\t\x22\x27\u2028\u2029\0]/g,function(s){switch(s){case"\\":return"\\\\";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";case'"':return++dq,'"';case"'":return++sq,"'";case"\0":return"\\0"}return s}),ascii_only&&(str=to_ascii(str)),dq>sq?"'"+str.replace(/\x27/g,"\\'")+"'":'"'+str.replace(/\x22/g,'\\"')+'"'}function to_ascii(str){return str.replace(/[\u0080-\uffff]/g,function(ch){for(var code=ch.charCodeAt(0).toString(16);4>code.length;)code="0"+code;return"\\u"+code})}function gen_code(ast,options){function encode_string(str){var ret=make_string(str,options.ascii_only);return options.inline_script&&(ret=ret.replace(/<\x2fscript([>\/\t\n\f\r ])/gi,"<\\/script$1")),ret}function make_name(name){return name=name.toString(),options.ascii_only&&(name=to_ascii(name)),name}function indent(line){return null==line&&(line=""),beautify&&(line=repeat_string(" ",options.indent_start+indentation*options.indent_level)+line),line}function with_indent(cont,incr){null==incr&&(incr=1),indentation+=incr;try{return cont.apply(null,slice(arguments,1))}finally{indentation-=incr}}function last_char(str){return str=str.toString(),str.charAt(str.length-1)}function first_char(str){return str.toString().charAt(0)}function add_spaces(a){if(beautify)return a.join(" ");for(var b=[],i=0;a.length>i;++i){var next=a[i+1];b.push(a[i]),next&&(is_identifier_char(last_char(a[i]))&&(is_identifier_char(first_char(next))||"\\"==first_char(next))||/[\+\-]$/.test(a[i].toString())&&/^[\+\-]/.test(next.toString())||"/"==last_char(a[i])&&"/"==first_char(next))&&b.push(" ")}return b.join("")}function add_commas(a){return a.join(","+space)}function parenthesize(expr){for(var gen=make(expr),i=1;arguments.length>i;++i){var el=arguments[i];if(el instanceof Function&&el(expr)||expr[0]==el)return"("+gen+")"}return gen}function best_of(a){if(1==a.length)return a[0];if(2==a.length){var b=a[1];return a=a[0],b.length>=a.length?a:b}return best_of([a[0],best_of(a.slice(1))])}function needs_parens(expr){if("function"==expr[0]||"object"==expr[0])for(var a=slice(w.stack()),self=a.pop(),p=a.pop();p;){if("stat"==p[0])return!0;if(("seq"!=p[0]&&"call"!=p[0]&&"dot"!=p[0]&&"sub"!=p[0]&&"conditional"!=p[0]||p[1]!==self)&&("binary"!=p[0]&&"assign"!=p[0]&&"unary-postfix"!=p[0]||p[2]!==self))return!1;self=p,p=a.pop()}return!HOP(DOT_CALL_NO_PARENS,expr[0])}function make_num(num){var str=num.toString(10),a=[str.replace(/^0\./,".").replace("e+","e")],m;return Math.floor(num)===num?(num>=0?a.push("0x"+num.toString(16).toLowerCase(),"0"+num.toString(8)):a.push("-0x"+(-num).toString(16).toLowerCase(),"-0"+(-num).toString(8)),(m=/^(.*?)(0+)$/.exec(num))&&a.push(m[1]+"e"+m[2].length)):(m=/^0?\.(0+)(.*)$/.exec(num))&&a.push(m[2]+"e-"+(m[1].length+m[2].length),str.substr(str.indexOf("."))),best_of(a)}function make_then(th){if(null==th)return";";if("do"==th[0])return make_block([th]);for(var b=th;;){var type=b[0];if("if"==type){if(!b[3])return make(["block",[th]]);b=b[3]}else if("while"==type||"do"==type)b=b[2];else{if("for"!=type&&"for-in"!=type)break;b=b[4]}}return make(th)}function make_function(name,args,body,keyword,no_parens){var out=keyword||"function";return name&&(out+=" "+make_name(name)),out+="("+add_commas(MAP(args,make_name))+")",out=add_spaces([out,make_block(body)]),!no_parens&&needs_parens(this)?"("+out+")":out}function must_has_semicolon(node){switch(node[0]){case"with":case"while":return empty(node[2])||must_has_semicolon(node[2]);case"for":case"for-in":return empty(node[4])||must_has_semicolon(node[4]);case"if":return empty(node[2])&&!node[3]?!0:node[3]?empty(node[3])?!0:must_has_semicolon(node[3]):must_has_semicolon(node[2]);case"directive":return!0}}function make_block_statements(statements,noindent){for(var a=[],last=statements.length-1,i=0;last>=i;++i){var stat=statements[i],code=make(stat);";"!=code&&(beautify||i!=last||must_has_semicolon(stat)||(code=code.replace(/;+\s*$/,"")),a.push(code))}return noindent?a:MAP(a,indent)}function make_switch_block(body){var n=body.length;return 0==n?"{}":"{"+newline+MAP(body,function(branch,i){var has_body=branch[1].length>0,code=with_indent(function(){return indent(branch[0]?add_spaces(["case",make(branch[0])+":"]):"default:")},.5)+(has_body?newline+with_indent(function(){return make_block_statements(branch[1]).join(newline)}):"");return!beautify&&has_body&&n-1>i&&(code+=";"),code}).join(newline)+newline+indent("}")}function make_block(statements){return statements?0==statements.length?"{}":"{"+newline+with_indent(function(){return make_block_statements(statements).join(newline)})+newline+indent("}"):";"}function make_1vardef(def){var name=def[0],val=def[1];return null!=val&&(name=add_spaces([make_name(name),"=",parenthesize(val,"seq")])),name}options=defaults(options,{indent_start:0,indent_level:4,quote_keys:!1,space_colon:!1,beautify:!1,ascii_only:!1,inline_script:!1});var beautify=!!options.beautify,indentation=0,newline=beautify?"\n":"",space=beautify?" ":"",w=ast_walker(),make=w.walk;return w.with_walkers({string:encode_string,num:make_num,name:make_name,"debugger":function(){return"debugger;"},toplevel:function(statements){return make_block_statements(statements).join(newline+newline)},splice:function(statements){var parent=w.parent();return HOP(SPLICE_NEEDS_BRACKETS,parent)?make_block.apply(this,arguments):MAP(make_block_statements(statements,!0),function(line,i){return i>0?indent(line):line}).join(newline)},block:make_block,"var":function(defs){return"var "+add_commas(MAP(defs,make_1vardef))+";"},"const":function(defs){return"const "+add_commas(MAP(defs,make_1vardef))+";"},"try":function(tr,ca,fi){var out=["try",make_block(tr)];return ca&&out.push("catch","("+ca[0]+")",make_block(ca[1])),fi&&out.push("finally",make_block(fi)),add_spaces(out)},"throw":function(expr){return add_spaces(["throw",make(expr)])+";"},"new":function(ctor,args){return args=args.length>0?"("+add_commas(MAP(args,function(expr){return parenthesize(expr,"seq")}))+")":"",add_spaces(["new",parenthesize(ctor,"seq","binary","conditional","assign",function(expr){var w=ast_walker(),has_call={};try{w.with_walkers({call:function(){throw has_call},"function":function(){return this}},function(){w.walk(expr)})}catch(ex){if(ex===has_call)return!0;throw ex}})+args])},"switch":function(expr,body){return add_spaces(["switch","("+make(expr)+")",make_switch_block(body)])},"break":function(label){var out="break";return null!=label&&(out+=" "+make_name(label)),out+";"},"continue":function(label){var out="continue";return null!=label&&(out+=" "+make_name(label)),out+";"},conditional:function(co,th,el){return add_spaces([parenthesize(co,"assign","seq","conditional"),"?",parenthesize(th,"seq"),":",parenthesize(el,"seq")])},assign:function(op,lvalue,rvalue){return op&&op!==!0?op+="=":op="=",add_spaces([make(lvalue),op,parenthesize(rvalue,"seq")])},dot:function(expr){var out=make(expr),i=1;for("num"==expr[0]?/[a-f.]/i.test(out)||(out+="."):"function"!=expr[0]&&needs_parens(expr)&&(out="("+out+")");arguments.length>i;)out+="."+make_name(arguments[i++]);return out},call:function(func,args){var f=make(func),already_wrapped="function"==func[0]&&"("==f.charAt(0);return!already_wrapped&&needs_parens(func)&&(f="("+f+")"),f+"("+add_commas(MAP(args,function(expr){return parenthesize(expr,"seq")}))+")"},"function":make_function,defun:make_function,"if":function(co,th,el){var out=["if","("+make(co)+")",el?make_then(th):make(th)];return el&&out.push("else",make(el)),add_spaces(out)},"for":function(init,cond,step,block){var out=["for"];init=(null!=init?make(init):"").replace(/;*\s*$/,";"+space),cond=(null!=cond?make(cond):"").replace(/;*\s*$/,";"+space),step=(null!=step?make(step):"").replace(/;*\s*$/,"");var args=init+cond+step;return"; ; "==args&&(args=";;"),out.push("("+args+")",make(block)),add_spaces(out)},"for-in":function(vvar,key,hash,block){return add_spaces(["for","("+(vvar?make(vvar).replace(/;+$/,""):make(key)),"in",make(hash)+")",make(block)])},"while":function(condition,block){return add_spaces(["while","("+make(condition)+")",make(block)])},"do":function(condition,block){return add_spaces(["do",make(block),"while","("+make(condition)+")"])+";"},"return":function(expr){var out=["return"];return null!=expr&&out.push(make(expr)),add_spaces(out)+";"},binary:function(operator,lvalue,rvalue){var left=make(lvalue),right=make(rvalue);return(member(lvalue[0],["assign","conditional","seq"])||"binary"==lvalue[0]&&PRECEDENCE[operator]>PRECEDENCE[lvalue[1]]||"function"==lvalue[0]&&needs_parens(this))&&(left="("+left+")"),member(rvalue[0],["assign","conditional","seq"])||"binary"==rvalue[0]&&PRECEDENCE[operator]>=PRECEDENCE[rvalue[1]]&&(rvalue[1]!=operator||!member(operator,["&&","||","*"]))?right="("+right+")":beautify||!options.inline_script||"<"!=operator&&"<<"!=operator||"regexp"!=rvalue[0]||!/^script/i.test(rvalue[1])||(right=" "+right),add_spaces([left,operator,right])},"unary-prefix":function(operator,expr){var val=make(expr);return"num"!=expr[0]&&("unary-prefix"!=expr[0]||HOP(OPERATORS,operator+expr[1]))&&needs_parens(expr)&&(val="("+val+")"),operator+(jsp.is_alphanumeric_char(operator.charAt(0))?" ":"")+val},"unary-postfix":function(operator,expr){var val=make(expr);return"num"!=expr[0]&&("unary-postfix"!=expr[0]||HOP(OPERATORS,operator+expr[1]))&&needs_parens(expr)&&(val="("+val+")"),val+operator},sub:function(expr,subscript){var hash=make(expr);return needs_parens(expr)&&(hash="("+hash+")"),hash+"["+make(subscript)+"]"},object:function(props){var obj_needs_parens=needs_parens(this);if(0==props.length)return obj_needs_parens?"({})":"{}";var out="{"+newline+with_indent(function(){return MAP(props,function(p){if(3==p.length)return indent(make_function(p[0],p[1][2],p[1][3],p[2],!0));var key=p[0],val=parenthesize(p[1],"seq");return options.quote_keys?key=encode_string(key):("number"==typeof key||!beautify&&+key+""==key)&&parseFloat(key)>=0?key=make_num(+key):is_identifier(key)||(key=encode_string(key)),indent(add_spaces(beautify&&options.space_colon?[key,":",val]:[key+":",val]))}).join(","+newline)})+newline+indent("}");return obj_needs_parens?"("+out+")":out},regexp:function(rx,mods){return options.ascii_only&&(rx=to_ascii(rx)),"/"+rx+"/"+mods},array:function(elements){return 0==elements.length?"[]":add_spaces(["[",add_commas(MAP(elements,function(el,i){return beautify||"atom"!=el[0]||"undefined"!=el[1]?parenthesize(el,"seq"):i===elements.length-1?",":""})),"]"])},stat:function(stmt){return null!=stmt?make(stmt).replace(/;*\s*$/,";"):";"},seq:function(){return add_commas(MAP(slice(arguments),make))},label:function(name,block){return add_spaces([make_name(name),":",make(block)])},"with":function(expr,block){return add_spaces(["with","("+make(expr)+")",make(block)])
},atom:function(name){return make_name(name)},directive:function(dir){return make_string(dir)+";"}},function(){return make(ast)})}function split_lines(code,max_line_length){var splits=[0];return jsp.parse(function(){function current_length(tok){return tok.pos-last_split}function split_here(tok){last_split=tok.pos,splits.push(last_split)}function custom(){var tok=next_token.apply(this,arguments);out:if((!prev_token||"keyword"!=prev_token.type)&&current_length(tok)>max_line_length)switch(tok.type){case"keyword":case"atom":case"name":case"punc":split_here(tok);break out}return prev_token=tok,tok}var next_token=jsp.tokenizer(code),last_split=0,prev_token;return custom.context=function(){return next_token.context.apply(this,arguments)},custom}()),splits.map(function(pos,i){return code.substring(pos,splits[i+1]||code.length)}).join("\n")}function repeat_string(str,i){if(0>=i)return"";if(1==i)return str;var d=repeat_string(str,i>>1);return d+=d,1&i&&(d+=str),d}function defaults(args,defs){var ret={};args===!0&&(args={});for(var i in defs)HOP(defs,i)&&(ret[i]=args&&HOP(args,i)?args[i]:defs[i]);return ret}function is_identifier(name){return/^[a-z_$][a-z0-9_$]*$/i.test(name)&&"this"!=name&&!HOP(jsp.KEYWORDS_ATOM,name)&&!HOP(jsp.RESERVED_WORDS,name)&&!HOP(jsp.KEYWORDS,name)}function HOP(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var curry=jsp.curry,slice=jsp.slice,member=jsp.member,is_identifier_char=jsp.is_identifier_char,PRECEDENCE=jsp.PRECEDENCE,OPERATORS=jsp.OPERATORS,base54=function(){var DIGITS=base54_digits();return function(num){var ret="",base=54;do ret+=DIGITS.charAt(num%base),num=Math.floor(num/base),base=64;while(num>0);return ret}}();Scope.prototype={has:function(name){for(var s=this;s;s=s.parent)if(HOP(s.names,name))return s},has_mangled:function(mname){for(var s=this;s;s=s.parent)if(HOP(s.rev_mangled,mname))return s},toJSON:function(){return{names:this.names,uses_eval:this.uses_eval,uses_with:this.uses_with}},next_mangled:function(){for(;;){var m=base54(++this.cname),prior;if(prior=this.has_mangled(m),!(prior&&this.refs[prior.rev_mangled[m]]===prior||(prior=this.has(m),prior&&prior!==this&&this.refs[m]===prior&&!prior.has_mangled(m)||HOP(this.refs,m)&&null==this.refs[m]||!is_identifier(m))))return m}},set_mangle:function(name,m){return this.rev_mangled[m]=name,this.mangled[name]=m},get_mangled:function(name,newMangle){if(this.uses_eval||this.uses_with)return name;var s=this.has(name);return s?HOP(s.mangled,name)?s.mangled[name]:newMangle?s.set_mangle(name,s.next_mangled()):name:name},references:function(name){return name&&!this.parent||this.uses_with||this.uses_eval||this.refs[name]},define:function(name,type){return null!=name?("var"!=type&&HOP(this.names,name)||(this.names[name]=type||"var"),name):void 0},active_directive:function(dir){return member(dir,this.directives)||this.parent&&this.parent.active_directive(dir)}};var warn=function(){},when_constant=function(){function evaluate(expr){switch(expr[0]){case"string":case"num":return expr[1];case"name":case"atom":switch(expr[1]){case"true":return!0;case"false":return!1;case"null":return null}break;case"unary-prefix":switch(expr[1]){case"!":return!evaluate(expr[2]);case"typeof":return typeof evaluate(expr[2]);case"~":return~evaluate(expr[2]);case"-":return-evaluate(expr[2]);case"+":return+evaluate(expr[2])}break;case"binary":var left=expr[2],right=expr[3];switch(expr[1]){case"&&":return evaluate(left)&&evaluate(right);case"||":return evaluate(left)||evaluate(right);case"|":return evaluate(left)|evaluate(right);case"&":return evaluate(left)&evaluate(right);case"^":return evaluate(left)^evaluate(right);case"+":return evaluate(left)+evaluate(right);case"*":return evaluate(left)*evaluate(right);case"/":return evaluate(left)/evaluate(right);case"%":return evaluate(left)%evaluate(right);case"-":return evaluate(left)-evaluate(right);case"<<":return evaluate(left)<<evaluate(right);case">>":return evaluate(left)>>evaluate(right);case">>>":return evaluate(left)>>>evaluate(right);case"==":return evaluate(left)==evaluate(right);case"===":return evaluate(left)===evaluate(right);case"!=":return evaluate(left)!=evaluate(right);case"!==":return evaluate(left)!==evaluate(right);case"<":return evaluate(right)>evaluate(left);case"<=":return evaluate(right)>=evaluate(left);case">":return evaluate(left)>evaluate(right);case">=":return evaluate(left)>=evaluate(right);case"in":return evaluate(left)in evaluate(right);case"instanceof":return evaluate(left)instanceof evaluate(right)}}throw $NOT_CONSTANT}var $NOT_CONSTANT={};return function(expr,yes,no){try{var val=evaluate(expr),ast;switch(typeof val){case"string":ast=["string",val];break;case"number":ast=["num",val];break;case"boolean":ast=["name",String(val)];break;default:if(null===val){ast=["atom","null"];break}throw new Error("Can't handle constant of type: "+typeof val)}return yes.call(expr,ast,val)}catch(ex){if(ex===$NOT_CONSTANT){if("binary"!=expr[0]||"==="!=expr[1]&&"!=="!=expr[1]||!(is_string(expr[2])&&is_string(expr[3])||boolean_expr(expr[2])&&boolean_expr(expr[3]))){if(no&&"binary"==expr[0]&&("||"==expr[1]||"&&"==expr[1]))try{var lval=evaluate(expr[2]);expr="&&"==expr[1]&&(lval?expr[3]:lval)||"||"==expr[1]&&(lval?lval:expr[3])||expr}catch(ex2){}}else expr[1]=expr[1].substr(0,2);return no?no.call(expr,expr):null}throw ex}}}(),DOT_CALL_NO_PARENS=jsp.array_to_hash(["name","array","object","string","dot","sub","call","regexp","defun"]),SPLICE_NEEDS_BRACKETS=jsp.array_to_hash(["if","while","do","for","for-in","with"]),MAP;(function(){function AtTop(val){this.v=val}function Splice(val){this.v=val}MAP=function(a,f,o){function doit(){var val=f.call(o,a[i],i);val instanceof AtTop?(val=val.v,val instanceof Splice?top.push.apply(top,val.v):top.push(val)):val!=skip&&(val instanceof Splice?ret.push.apply(ret,val.v):ret.push(val))}var ret=[],top=[],i;if(a instanceof Array)for(i=0;a.length>i;++i)doit();else for(i in a)HOP(a,i)&&doit();return top.concat(ret)},MAP.at_top=function(val){return new AtTop(val)},MAP.splice=function(val){return new Splice(val)};var skip=MAP.skip={}})(),exports.ast_walker=ast_walker,exports.ast_mangle=ast_mangle,exports.ast_squeeze=ast_squeeze,exports.ast_lift_variables=ast_lift_variables,exports.gen_code=gen_code,exports.ast_add_scope=ast_add_scope,exports.set_logger=function(logger){warn=logger},exports.make_string=make_string,exports.split_lines=split_lines,exports.MAP=MAP})(process,parseJs),$(document).ready(function(){function evalJS(sourceCode,depends){try{if(depends){var println=function(x){},depEditor=$('div.editor[data-name="'+depends+'"]');eval(depEditor.data("initial"))}var ast=parseJs.parse(sourceCode).splice(1)[0],exprs=ast.map(function(astNode){return[astNode].unshift("toplevel"),process.gen_code(astNode,!1)}),output="";for(println=function(x){output+=x+"\n"};exprs.length>0;)try{var evaluated=eval(exprs.shift());evaluated&&evaluated.toString().match(/function\s/)&&(evaluated=evaluated.toString().split("\n")[0]+" .."),output+=evaluated+"\n"}catch(err){output+=err.name+": "+err.message+"\n"}return output.split(/\n/g).map(function(line){return"// "+line}).join("\n")}catch(err){return"// Invalid input: "+err.message+"\n"}}function fixEncoding(cm,text){text=text||cm.getValue();var decoded=$("<div/>").html(text).text();cm.setValue(decoded)}function modeName(className){switch(className){case"Java":return"text/x-java";case"Scheme":return"scheme";case void 0:case"NodeJS":default:return"javascript"}}function highlightBibItem(n){var li=$("li#"+n);li.css({opacity:.1}),li.animate({opacity:1},1e3)}function makeEqualityTable(cmpStr,table){function map(f,x){for(var result=[],i=0;x.length>i;i+=1)result.push(f(x[i]));return result}function repr(x){return"string"==typeof x?'"'+x.replace('"','\\"')+'"':x&&x.constructor===Array?"["+map(repr,x).join(", ")+"]":x&&"object"==typeof x?"{}":String(x)}var comparisons=[!0,!1,1,0,-1,"1","0","-1","",null,,[],{},[[]],[0],[1],parseFloat("nan")],curRow=$("<tr />").html("<td />"),representations=[],tVal,i,j,result,elem;for($.each(comparisons,function(i){tVal=repr(comparisons[i]),curRow.append($("<td />",{"class":"col header"}).html($("<span />").html(tVal))),representations.push(tVal)}),table.append(curRow),i=0;comparisons.length>i;i+=1){for(curRow=$("<tr />"),curRow.append($("<td />",{"class":"row header"}).html(representations[i])),j=0;comparisons.length>j;j+=1)elem=$("<td />",{"class":"cell"}).html("<div />"),"==="===cmpStr?comparisons[i]===comparisons[j]?(elem.addClass("green"),elem.attr("title",""+representations[i]+"==="+representations[j]+"  » true ")):(elem.addClass("red"),elem.attr("title",""+representations[i]+"==="+representations[j]+"  » false ")):"=="===cmpStr&&(comparisons[i]==comparisons[j]?(elem.addClass("green"),elem.attr("title",""+representations[i]+"=="+representations[j]+"  » true ")):(elem.addClass("red"),elem.attr("title",""+representations[i]+"=="+representations[j]+"  » false "))),curRow.append(elem);table.append(curRow)}}var editors=$("pre").map(function(index,pre){var id="editor"+index,codeMirror=CodeMirror(function(editor){var $pre=$(pre),name=$pre.data("name"),depends=$pre.data("depends"),$div=$('<div class="editor" '+(name?'data-name="'+name+'" ':"")+'id="'+id+'"></div>'),$tabs=$('<ul class="tabs"><li>'+(pre.className||"JavaScript")+"</li>"+(pre.className?"":'<li><a href="#eval">Evaluate</a></li>')+'<li><a href="#reset">Reset</a></li>'+"</ul>");$div.append($tabs),$div.append(editor),$pre.replaceWith($div),$div.data("initial",pre.innerHTML),$('a[href="#eval"]',$tabs).click(function(event){event.preventDefault();var val=codeMirror.getValue();codeMirror.setValue(val+"\n\n// ########\n"+evalJS(val,depends)),fixEncoding(codeMirror)}),$('a[href="#reset"]',$tabs).click(function(event){event.preventDefault(),fixEncoding(codeMirror,$div.data("initial"))})},{value:pre.innerHTML,mode:modeName(pre.className),indentUnit:4,lineNumbers:!0,matchBrackets:!0,extraKeys:{"Ctrl-R":function(){$("div#"+id+" a[href='#reset']").click()},"Ctrl-E":pre.className?void 0:function(){$("div#"+id+""+" a[href='#eval']").click()}}});return fixEncoding(codeMirror),codeMirror});$("span.footnote").each(function(index,elem){var link=$('<a href="#" class="footnote">('+(index+1)+")</a>"),$elem=$(elem);$elem.before(link),$(link).click(function(e){e.preventDefault();var alreadyOpen=!1;if($("div.footnote").each(function(_,footnote){footnote.id=="footnote"+(index+1)&&(alreadyOpen=!0),$(footnote).remove()}),!alreadyOpen){var popup=$('<div id="footnote'+(index+1)+'" class="footnote">'+$elem.html()+"</div>"),$window=$(window);popup.css({left:Math.max(20,e.pageX-.3*$window.width())+"px",top:e.pageY+10+"px"}),$elem.after(popup),popup.click(function(e){if(popup.remove(),"bib"==e.target.className)highlightBibItem("bib-"+e.target.innerHTML);else{var bibLink=e.target.toString().match(/#(bib-\d+)\/?$/);bibLink&&highlightBibItem(bibLink[1])}})}})}),$('a.ref[href^="#bib-"]').click(function(e){highlightBibItem(this.href.split("#")[1])}),$('a[href="#top"]').click(function(e){e.preventDefault(),$("html, body").animate({scrollTop:$("#top").offset().top},"slow")}),makeEqualityTable("===",$("table#strict-equality-table")),makeEqualityTable("==",$("table#equality-table"));var pageDelay=1e3,$chapters=$("div.chapter"),loading=$('<div id="loading">Loading chapters (<span id="loaded">1</span>/'+($chapters.length-1)+")</div>");loading.css({right:"2em",top:"2em"}),$("body").after(loading);var loaded=$("span#loaded");$chapters.each(function(index,chapter){index>0&&setTimeout(function(){$(chapter).show(),loaded.html(index),index==$chapters.length-1&&(editors.each(function(index,editor){editor.refresh()}),setTimeout(function(){loading.remove()},pageDelay))},(index+1)*pageDelay)})});